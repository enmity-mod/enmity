try{Promise.resolve().then(function(){return Assets$2}).then(()=>{Promise.resolve().then(function(){return index$1}).then(e=>{e.initialize()})})}catch(error){alert(`Enmity failed to initialize: ${error.message}`),console.error(error)}const modules$1={Constants:{props:["Endpoints","API_HOST"]},Clipboard:{props:["setString","getString"]},Assets:{props:["registerAsset"]},Messages:{props:["receiveMessage","sendMessage"]},Clyde:{props:["createBotMessage"]},Avatars:{props:["BOT_AVATARS"]},Native:{props:["NativeModules"],export:"NativeModules"},React:{props:["createElement"]},Dispatcher:{props:["_dispatch","dispatch"]},Storage:{props:["getItem"]},Toasts:{props:["open","close"],ensure:e=>!e.openLazy&&!e.startDrag&&!e.init&&!e.openReplay&&!e.setAlwaysOnTop},Dialog:{props:["show","openLazy","close"]},Token:{props:["getToken"]},REST:{props:["getAPIBaseURL"]},Settings:{props:["watchKeys"]},Users:{props:["getCurrentUser"]},Navigation:{props:["pushLazy"]},NavigationNative:{props:["NavigationContainer"]},NavigationStack:{props:["createStackNavigator"]},Theme:{props:["theme"]},Linking:{props:["openURL"]},StyleSheet:{props:["createThemedStyleSheet"]},ColorMap:{props:["ThemeColorMap"]},Components:{multiple:!0,props:{Forms:["Form","FormSection"],General:["Button","Text","View"]}},Locale:{props:["Messages"]},Profiles:{props:["showUserProfile"]},Lodash:{props:["debounce","throttle"]},Logger:{name:"Logger"},Flux:{props:[["Store","connectStores"],["useStateFromStoresObject"]]},SVG:{props:["Svg"]},Scenes:{name:"getScreens",default:!1},Moment:{props:["isMoment"]}},common={},blacklist=[],filters={byProps:(...e)=>t=>e.every(e=>void 0!==t[e]),byName:(e,t=!0)=>n=>!!n&&(t?"function"==typeof n&&n.name===e:"function"==typeof n.default&&n.default.name===e),byTypeName:(e,t=!0)=>n=>!!n&&(t?"function"==typeof n&&n.name===e:"function"==typeof n.default&&n.default.type?.name===e),byDisplayName:(e,t=!0)=>n=>!!n&&(t?"function"==typeof n&&n.name===e:"function"==typeof n.default&&n.default.name===e)},getters=[];Object.entries(modules$1).map(([e,t])=>{if(t.multiple)Object.entries(t.props).map(([t,n])=>{getters.push({id:t,filter(e){let t=filters.byProps(...n)(e);return t},submodule:e})});else if(t.props){if(t.props.every(e=>Array.isArray(e))){let n=[];getters.push({id:e,filter(e){let r=t.props.some(t=>t.every(t=>e[t]));return(!r||!t.ensure||!!t.ensure(e))&&(r&&n.push(e),r)},map:Object.assign({},...n)})}else getters.push({id:e,filter(e){let n=filters.byProps(...t.props)(e);return(!n||!t.ensure||!1!==t.ensure(e))&&n},map:t.export})}else t.displayName?getters.push({id:e,filter:filters.byDisplayName(t.displayName,t.default),map:t.export}):t.name?getters.push({id:e,filter:filters.byName(t.name,t.default),map:t.export}):t.filter&&getters.push({id:e,filter:t.filter,map:t.export})});const results=bulk(...getters.map(({filter:e})=>e));function getModule(e,{all:t=!1,traverse:n=!1,defaultExport:r=!0}={}){if("function"!=typeof e)return null;let o=[],i=function(t,n){try{return e(t,n)}catch{return!1}},a=common.Locale&&common.Locale.getLocale();for(let l in modules){if(blacklist.includes(l))continue;if(!modules[l].isInitialized)try{__r(l)}catch(s){blacklist.push(l);continue}common.Moment&&a&&common.Moment.locale(a);let c=modules[l].publicModule.exports;if(!c||c===window||null===c.ihateproxies){blacklist.push(l);continue}if("object"==typeof c){if(i(c,l)){if(!t)return c;o.push(c)}if(c.default&&i(c.default,l)){let u=r?c.default:c;if(!t)return u;o.push(u)}if(n&&c.__esModule){for(let d in c)if(void 0!==c[d]&&i(c[d],l)){if(!t)return c[d];o.push(c[d])}}}else if("function"==typeof c){if(!i(c,l))continue;if(!t)return c;o.push(c)}}return t?o:o[0]}function getModules(e){return getModule(e,{all:!0})}function bulk(...e){let t=Array(e.length),n=e.map(e=>t=>{try{return e(t)}catch{return!1}});return getModule(r=>{for(let o=0;o<n.length;o++){let i=n[o];"function"==typeof i&&i(r)&&null==t[o]&&(t[o]=r)}return t.filter(String).length===e.length}),t}function getByProps(...e){let[t,{bulk:n=!1,...r}]=parseOptions(e);if(n){let o=t.map(e=>Array.isArray(e)?filters.byProps(...e):filters.byProps(e)).concat({...r});return bulk(...o)}return getModule(filters.byProps(...t),r)}function getByDisplayName(...e){let[t,{bulk:n=!1,default:r=!0,...o}]=parseOptions(e);if(n){let i=t.map(filters.byDisplayName).concat({defaultExport:r,...o});return bulk(...i)}return getModule(filters.byDisplayName(t[0]),{defaultExport:r,...o})}function getByTypeName(...e){let[t,{bulk:n=!1,default:r=!0,...o}]=parseOptions(e);if(n){let i=t.map(filters.byTypeName).concat({defaultExport:r,...o});return bulk(...i)}return getModule(filters.byTypeName(t[0]),{defaultExport:r,...o})}function getByName$1(...e){let[t,{bulk:n=!1,default:r=!0,...o}]=parseOptions(e);if(n){let i=t.map(filters.byName).concat({defaultExport:r,...o});return bulk(...i)}return getModule(filters.byName(t[0]),{defaultExport:r,...o})}function getByKeyword(...e){let[[t],{caseSensitive:n=!1,all:r=!1,...o}]=parseOptions(e);return getModule(e=>{let r=[...Object.keys(e),...Object.keys(e.__proto__)];for(let o=0;o<r.length;o++){let i=r[o];if(n){if(~i.indexOf(t))return!0}else{let a=t.toLowerCase();if(~i.toLowerCase().indexOf(a))return!0}}return!1},{all:r,...o})}function parseOptions(e,t=e=>"object"==typeof e&&!Array.isArray(e)){return[e,t(e[e.length-1])?e.pop():{}]}getters.map(({id:e,map:t,submodule:n},r)=>{let o=e=>e;if("string"==typeof t)o=e=>e[t];else if(Array.isArray(t)){let i={};o=e=>{for(let n of t)i[n]=e[n];return i}}if(!results[r])return;let a=o(results[r]);n?(common[n]??={},common[n][e]=a):common[e]=a});var Type,ApplicationCommandSectionType,ApplicationCommandType,ApplicationCommandInputType,ApplicationCommandPermissionType,ApplicationCommandOptionType,InteractionTypes,Times,Modules=Object.freeze({__proto__:null,common:common,blacklist:blacklist,filters:filters,getModule:getModule,getModules:getModules,bulk:bulk,getByProps:getByProps,getByDisplayName:getByDisplayName,getByTypeName:getByTypeName,getByName:getByName$1,getByKeyword:getByKeyword});const{Clipboard,Assets:Assets$3,Messages,Clyde:Clyde$1,Avatars,Native,Dispatcher,Storage,Toasts,Dialog,Token,REST,Settings:Settings$3,Users,Theme,Linking,StyleSheet:StyleSheet$1,ColorMap,Components:Components$1,Locale,Constants,Profiles,Logger:Logger$1,Lodash,Flux,SVG,Scenes,Navigation,NavigationNative,NavigationStack,Moment}=common;common.React;const patches=[];function getPatchesByCaller(e){if(!e)return[];let t=[];for(let n of patches){let r=[...n.patches.before,...n.patches.instead,...n.patches.after];for(let o of r)o.caller===e&&t.push(o)}return t}function unpatchAll(e){let t=getPatchesByCaller(e);if(t.length)for(let n of t)n.unpatch()}function override(e){return function(){if(!e?.patches?.before.length&&!e?.patches?.after.length&&!e?.patches?.instead.length&&!patches.find(t=>t.mdl===e.mdl&&t.func===e.func))return e.unpatch(),new.target?new e.original(...arguments):e.original.apply(this,arguments);let t,n=arguments,r=e.patches.before;for(let o=0;o<r.length;o++){let i=r[o];if(i)try{let a=i.callback(this,n,e.original.bind(this));Array.isArray(a)&&(n=a),i.once&&i.unpatch()}catch(l){console.error(`Could not fire before patch for ${e.func} of ${i.caller}`),console.error(l)}}let s=e.patches.instead;if(s.length)for(let c=0;c<s.length;c++){let u=s[c];if(u)try{let d=u.callback(this,n,e.original.bind(this));void 0!==d&&(t=d),u.once&&u.unpatch()}catch(m){console.error(`Could not fire instead patch for ${e.func} of ${u.caller}`),console.error(m)}}else t=new.target?new e.original(...n):e.original.apply(this,n);let p=e.patches.after;for(let f=0;f<p.length;f++){let h=p[f];if(h)try{let g=h.callback(this,n,t,e=>t=e);void 0!==g&&(t=g),h.once&&h.unpatch()}catch(y){console.error(`Could not fire after patch for ${e.func} of ${h.caller}`),console.error(y)}}return t}}function push([,e,t,,n,r]){let o={mdl:e,func:t,id:patches?.[n]?.length??0,original:e[t],once:r,unpatch(){o.mdl[o.func]=o.original,o.patches={before:[],after:[],instead:[]}},patches:{before:[],after:[],instead:[]}};e[t]=override(o);let i=Object.getOwnPropertyDescriptors(o.original);return delete i.length,Object.defineProperties(e[t],{...i,toString:{value:()=>o.original.toString(),configurable:!0,enumerable:!1},__original:{value:o.original,configurable:!0,enumerable:!1}}),patches.push(o),o}function get$2([,e,t]){let n=patches.find(n=>n.mdl===e&&n.func===t);return n||push(...arguments)}function patch(e,t,n,r,o=Type.After,i=!1){if(e&&"string"==typeof e){if(t&&["function","object"].includes(typeof t)){if(n&&"string"==typeof n){if(r&&"function"==typeof r){if(o&&"string"==typeof o&&["after","before","instead"].includes(o)){if(void 0===t[n])throw ReferenceError(`function ${n} does not exist on the second argument (object or function)`)}else throw TypeError('fifth argument "type" must be of type string and any of the three: after, before, instead')}else throw TypeError('fourth argument "callback" must be of type function')}else throw TypeError('third argument "func" must be of type string')}else throw TypeError('second argument "mdl" must be of type function or object')}else throw TypeError('first argument "caller" must be of type string');let a=get$2(arguments),l={caller:e,once:i,type:o,id:a.patches?.[o]?.length??0,callback:r,unpatch(){let e=a.patches?.[o].findIndex(e=>e.id===l.id);if(~e&&a.patches?.[o].splice(e,1),a.patches?.before.length||a.patches?.after.length||a.patches?.instead.length)return;let r=patches.findIndex(e=>e.mdl==t&&e.func==n);r&&(patches[r]?.unpatch(),patches.splice(r,1))}};return a.patches[o]??=[],a.patches[o].push(l),l.unpatch}function before(e,t,n,r,o=!1){return patch(e,t,n,r,Type.Before,o)}function instead(e,t,n,r,o=!1){return patch(e,t,n,r,Type.Instead,o)}function after(e,t,n,r,o=!1){return patch(e,t,n,r,Type.After,o)}function create(e){return{getPatchesByCaller:getPatchesByCaller,before:(t,n,r)=>before(e,t,n,r),instead:(t,n,r)=>instead(e,t,n,r),after:(t,n,r)=>after(e,t,n,r),unpatchAll:()=>unpatchAll(e)}}!function(e){e.Before="before",e.Instead="instead",e.After="after"}(Type||(Type={}));var Patcher$4={create,before,instead,after,unpatchAll,patches},Patcher$5=Object.freeze({__proto__:null,create:create,before:before,instead:instead,after:after,unpatchAll:unpatchAll,patches:patches,default:Patcher$4});const assets={};try{Patcher$4.after("enmity-assets",Assets$3,"registerAsset",(e,[t],n)=>{assets[t.name]={...t,id:n}});for(let id=1;;id++){let asset=Assets$3.getAssetByID(id);if(!asset)break;assets[asset.name]||(assets[asset.name]={...asset,id})}}catch{}function find(e){return Object.values(assets).find(e)}function getByName(e){return assets[e]}function getByID(e){return Assets$3.getAssetByID(e)}function getIDByName(e){return assets[e]?.id}var Assets$1={assets,getByName,getByID,getIDByName},Assets$2=Object.freeze({__proto__:null,assets:assets,find:find,getByName:getByName,getByID:getByID,getIDByName:getIDByName,default:Assets$1});const settings=Settings$3.get("enmity")??{};function getSetting(e,t,n){return settings[e]?.[t]??n}function get$1(e){return settings[e]??{}}function getAll(){return settings}const Events$2={ENMITY_GET_SETTING:({file:e,setting:t,defaults:n})=>settings[e][t]??n,ENMITY_SET_SETTING({file:e,setting:t,value:n}){settings[e]||(settings[e]={}),void 0==n?delete settings[e][t]:settings[e][t]=n},ENMITY_TOGGLE_SETTING({file:e,setting:t,defaults:n}){settings[e]||(settings[e]={}),void 0===settings[e][t]?settings[e][t]=!Boolean(n):settings[e][t]=!Boolean(settings[e][t])}},store=new Flux.Store(Dispatcher,Events$2);store.addChangeListener(Lodash.debounce(()=>Settings$3.set({enmity:settings}),200));var Manager={store,getAll,getSetting,get:get$1},React=common.React;const listeners={};function ENMITY_SET_SETTING(e){return handleSettingsUpdate({...e,type:"set"})}function ENMITY_TOGGLE_SETTING(e){return handleSettingsUpdate({...e,type:"toggle"})}function handleSettingsUpdate({file:e,type:t,...n}){let r=listeners[e];if(r)for(let o of r.values())o({...n})}function set(e,t,n){if(e&&"string"==typeof e){if(!t||"string"!=typeof t)throw TypeError("the second argument setting must be of type string")}else throw TypeError("the first argument file must be of type string");return Dispatcher.wait(()=>Dispatcher.dispatch({type:"ENMITY_SET_SETTING",file:e,setting:t,value:n}))}function get(e,t,n){if(e&&"string"==typeof e){if(!t||"string"!=typeof t)throw TypeError("the second argument setting must be of type string")}else throw TypeError("the first argument file must be of type string");return Manager.getSetting(e,t,n)}function getBoolean(e,t,n){if(e&&"string"==typeof e){if(t&&"string"==typeof t){if(void 0===n||"boolean"!=typeof n)throw TypeError("the third argument defaults must be of type boolean")}else throw TypeError("the second argument setting must be of type string")}else throw TypeError("the first argument file must be of type string");return Boolean(Manager.getSetting(e,t,n))}function toggle(e,t,n){if(e&&"string"==typeof e){if(t&&"string"==typeof t){if(void 0===n||"boolean"!=typeof n)throw TypeError("the third argument defaults must be of type boolean")}else throw TypeError("the second argument setting must be of type string")}else throw TypeError("the first argument file must be of type string");return Dispatcher.wait(()=>Dispatcher.dispatch({type:"ENMITY_TOGGLE_SETTING",file:e,setting:t,defaults:n}))}function connectComponent(e,t){if(e&&["function","object"].includes(typeof e)){if(!t||"string"!=typeof t)throw TypeError("the second argument file must be of type string")}else throw TypeError("the first argument component must be of type function or object");let n=n=>{let r=React.useState({})[1];return React.useEffect(()=>{function e(){r({})}return subscribe(t,e),()=>unsubscribe(t,e)},[]),React.createElement(e,{...n,settings:makeStore(t)})};return e.displayName&&(n.displayName=e.displayName),e.name&&(n.name=`Connected${e.name}`),n}function makeStore(e){if(!e||"string"!=typeof e)throw TypeError("the first argument file must be of type string");return{settings:Manager.get(e),set:(t,n)=>set(e,t,n),get:(t,n)=>get(e,t,n),toggle:(t,n)=>toggle(e,t,n),getBoolean:(t,n)=>getBoolean(e,t,n)}}function subscribe(e,t){if(e&&"string"==typeof e){if(!t||"function"!=typeof t)throw TypeError("the second argument callback must be of type function")}else throw TypeError("the first argument file must be of type string");listeners[e]??=new Set,listeners[e].add(t)}function unsubscribe(e,t){if(e&&"string"==typeof e){if(!t||"function"!=typeof t)throw TypeError("the second argument callback must be of type function")}else throw TypeError("the first argument file must be of type string");listeners[e]?.delete(t),listeners[e]?.size===0&&delete listeners[e]}function connectStores(e,t){if(e&&["function","object"].includes(typeof e)){if(!t||"string"!=typeof t)throw TypeError("the second argument file must be of type string")}else throw TypeError("the first argument component must be of type function or object");return Flux.connectStores([Manager.store],()=>({settings:makeStore(t)}))(e)}Dispatcher.subscribe("ENMITY_SET_SETTING",ENMITY_SET_SETTING),Dispatcher.subscribe("ENMITY_TOGGLE_SETTING",ENMITY_TOGGLE_SETTING);var Settings$1={connectComponent,connectStores,unsubscribe,subscribe,makeStore,listeners,toggle,get,set},Settings$2=Object.freeze({__proto__:null,listeners:listeners,set:set,get:get,getBoolean:getBoolean,toggle:toggle,connectComponent:connectComponent,makeStore:makeStore,subscribe:subscribe,unsubscribe:unsubscribe,connectStores:connectStores,default:Settings$1,settings:settings,store:store});const Logger=getByName$1("Logger"),EnmityLogger=new Logger("Enmity");let socket;function connectWebsocket(host){console.log("Connecting to debug WebSocket"),void 0!==socket&&socket.readyState!==WebSocket.CLOSED&&(socket.close(),socket=null);let address=Boolean(Settings$1.get("enmity","autoConnectWS",!1))&&Settings$1.get("enmity","debugWSAddress");(address||host)&&((socket=new WebSocket(`ws://${host??address}`)).addEventListener("open",()=>{console.log("Connected with debug websocket"),Toasts.open({content:"Connected to the WebSocket server.",source:getIDByName("Check")})}),socket.addEventListener("error",e=>{console.log(`Error with debug websocket: ${e.message}`),Toasts.open({content:"An error occured with the websocket connection.",source:getIDByName("toast_copy_link")})}),socket.addEventListener("close",e=>{console.log(`Error with debug websocket: ${e.message}`),Toasts.open({content:"The websocket connection has been closed.",source:getIDByName("toast_copy_link")})}),socket.addEventListener("message",message=>{try{console.log(eval(message.data))}catch(e){console.error(e)}}))}function initialize$5(){let e=nativeLoggingHook;globalThis.nativeLoggingHook=function(t,n){return socket?.readyState===WebSocket.OPEN&&socket.send(JSON.stringify({level:n,message:t})),EnmityLogger.log(t),e.apply(this,arguments)},Settings$1.get("enmity","autoConnectWS",!1)&&connectWebsocket()}function sendMessage(e){socket?.readyState===WebSocket.OPEN&&socket.send(e)}var WebSocket$1={initialize:initialize$5,sendMessage,connectWebsocket,socket};const{Alert,Button,FlatList,Image,ImageBackground,KeyboardAvoidingView,Modal,Pressable,RefreshControl,ScrollView,SectionList,StatusBar,StyleSheet,Switch,Text,TextInput,TouchableHighlight,TouchableOpacity,TouchableWithoutFeedback,Touchable,View,VirtualizedList}=Components$1.General,{Form,FormArrow,FormCTA,FormCTAButton,FormCardSection,FormCheckbox,FormDivider,FormHint,FormIcon,FormInput,FormLabel,FormRadio,FormRow,FormSection,FormSelect,FormSubLabel,FormSwitch,FormTernaryCheckBox,FormText,FormTextColors,FormTextSizes}=Components$1.Forms;var Components=Object.freeze({__proto__:null,Alert:Alert,Button:Button,FlatList:FlatList,Image:Image,ImageBackground:ImageBackground,KeyboardAvoidingView:KeyboardAvoidingView,Modal:Modal,Pressable:Pressable,RefreshControl:RefreshControl,ScrollView:ScrollView,SectionList:SectionList,StatusBar:StatusBar,StyleSheet:StyleSheet,Switch:Switch,Text:Text,TextInput:TextInput,TouchableHighlight:TouchableHighlight,TouchableOpacity:TouchableOpacity,TouchableWithoutFeedback:TouchableWithoutFeedback,Touchable:Touchable,View:View,VirtualizedList:VirtualizedList,Form:Form,FormArrow:FormArrow,FormCTA:FormCTA,FormCTAButton:FormCTAButton,FormCardSection:FormCardSection,FormCheckbox:FormCheckbox,FormDivider:FormDivider,FormHint:FormHint,FormIcon:FormIcon,FormInput:FormInput,FormLabel:FormLabel,FormRadio:FormRadio,FormRow:FormRow,FormSection:FormSection,FormSelect:FormSelect,FormSubLabel:FormSubLabel,FormSwitch:FormSwitch,FormTernaryCheckBox:FormTernaryCheckBox,FormText:FormText,FormTextColors:FormTextColors,FormTextSizes:FormTextSizes});function memoize(e){let t;return(...n)=>t??=e.apply(null,n)}function debounce(e,t){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>e.apply(this,r),t)}}function uuid(e=10){let t="";do{let n=16*Math.random()|0;t+=(12==t.length?4:16==t.length?3&n|8:n).toString(16)}while(t.length<e);return t}function createStore(e){let t={...e??{}},n=uuid().toUpperCase(),r={get:(e,n)=>t[e]??n,set:(e,t)=>Dispatcher.wait(()=>Dispatcher.dispatch({type:`ENMITY_FLUX_${n}_SET`,key:e,value:t})),delete:e=>r.set(e,void 0)},o=new Flux.Store(Dispatcher,{[`ENMITY_FLUX_${n}_SET`]({key:e,value:n}){void 0===n?delete t[e]:t[e]=n}});return{...r,store:o,storage:t,id:n}}function findInTree(e={},t=e=>e,{ignore:n=[],walkable:r=[],maxProperties:o=100}={}){let i=[e],a=function(...e){try{return Reflect.apply(t,this,e)}catch{return!1}};for(;i.length&&o;){let l=i.shift();if(a(l))return l;if(Array.isArray(l))i.push(...l);else if("object"==typeof l&&null!==l){if(r.length)for(let s in l){let c=l[s];~r.indexOf(s)&&!~n.indexOf(s)&&i.push(c)}else for(let u in l){let d=l[u];l&&~n.indexOf(u)||i.push(d)}}o--}}function findInReactTree(e,t=e=>e,n={}){return findInTree(e,t,{walkable:["props","children"],...n})}const{PixelRatio}=Components$1.General;function normalizeSize(e){return PixelRatio.getPixelSizeForLayoutSize(e)}const overrides={useMemo:e=>e(),useState:e=>[e,()=>void 0],useReducer:e=>[e,()=>void 0],useEffect(){},useLayoutEffect(){},useRef:()=>({current:null}),useCallback:e=>e},keys=Object.keys(overrides);var wrapInHooks=e=>(...t)=>{let n=React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher.current,r=keys.map(e=>[e,n[e]]);Object.assign(n,overrides);let o={rendered:null,error:null};try{o.rendered=e(...t)}catch(i){o.error=i}if(Object.assign(n,Object.fromEntries(r)),o.error)throw o.error;return o.rendered};function sleep(e){return new Promise(t=>setTimeout(t,e))}var Utilities=Object.freeze({__proto__:null,memoize:memoize,debounce:debounce,createStore:createStore,findInReactTree:findInReactTree,normalizeSize:normalizeSize,wrapInHooks:wrapInHooks,findInTree:findInTree,sleep:sleep,uuid:uuid});const Settings=NavigationStack.createStackNavigator(),{ThemeColorMap:ThemeColorMap$6}=ColorMap;function PluginSettings({name:e="hi",children:t=React.createElement(Text,null,"hi")}={}){let n=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_PRIMARY,color:ThemeColorMap$6.TEXT_NORMAL},header:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:ThemeColorMap$6.HEADER_PRIMARY},close:{color:ThemeColorMap$6.HEADER_PRIMARY}});return React.createElement(NavigationNative.NavigationContainer,null,React.createElement(Settings.Navigator,{initialRouteName:e,style:n.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:n.cardStyle,headerStyle:n.header,headerTitleContainerStyle:n.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},React.createElement(Settings.Screen,{name:e,component:t,options:{headerTitleStyle:{color:"white"},headerLeft:()=>React.createElement(Button,{color:n.close.color,title:"Close",onPress:()=>Navigation.pop()}),...NavigationStack.TransitionPresets.ModalSlideFromBottomIOS}})))}!function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"}(ApplicationCommandSectionType||(ApplicationCommandSectionType={})),function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"}(ApplicationCommandType||(ApplicationCommandType={})),function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"}(ApplicationCommandInputType||(ApplicationCommandInputType={})),function(e){e[e.Role=1]="Role",e[e.User=2]="User"}(ApplicationCommandPermissionType||(ApplicationCommandPermissionType={})),function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number",e[e.Attachment=11]="Attachment"}(ApplicationCommandOptionType||(ApplicationCommandOptionType={})),function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"}(InteractionTypes||(InteractionTypes={}));const Patcher$3=create("enmity-commands"),[Commands$1,Assets,SearchStore]=bulk(filters.byProps("getBuiltInCommands"),filters.byProps("getApplicationIconURL"),filters.byProps("useSearchManager"));let commands=[];const section={id:"enmity",type:1,name:"Enmity",icon:"https://files.enmity.app/icon.png"};try{initialize$4()}catch(e){console.error("Failed to patch commands: ",e.message)}function registerCommands(e,t){if(e&&"string"==typeof e){if(!t||!Array.isArray(t))throw TypeError("second argument cmds must be of type array")}else throw TypeError("first argument caller must be of type string");for(let n in t){let r=t[n];t[n]={displayName:r.name,displayDescription:r.description,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,id:`enmity-${r.name.replaceAll(" ","-")}`,applicationId:section.id,...r,__enmity:!0,caller:e}}commands.push(...t)}function unregisterCommands(e){if(!e||"string"!=typeof e)throw TypeError("first argument caller must be of type string");commands=commands.filter(t=>t.caller!==e)}function initialize$4(){Commands$1.BUILT_IN_SECTIONS.enmity=section,Patcher$3.after(SearchStore.default,"getQueryCommands",(e,[,,t],n)=>{if(!(!t||t.startsWith("/"))){for(let r of(n??=[],commands))if(!(!~r.name?.indexOf(t)||n.some(e=>e.__enmity&&e.id===r.id)))try{n.unshift(r)}catch{n=[...n,r]}}}),Patcher$3.instead(SearchStore.default,"getApplicationSections",(e,t,n)=>{try{let r=n.apply(self,t)??[];return r.find(e=>e.id===section.id)||r.push(section),r}catch{return[]}}),Patcher$3.after(SearchStore,"useSearchManager",(e,[,t],n)=>{if(1!==t)return;if(n.sectionDescriptors?.find?.(e=>e.id===section.id)||(n.sectionDescriptors??=[],n.sectionDescriptors.push(section)),n.filteredSectionId&&n.filteredSectionId!==section.id||n.activeSections.find(e=>e.id===section.id)||n.activeSections.push(section),commands.some(e=>!n.commands?.find?.(t=>t.id===e.id))){n.commands??=[];let r=[...n.commands,...commands];n.commands=[...new Set(r).values()]}n.filteredSectionId&&n.filteredSectionId!==section.id||n.commandsByActiveSection.find(e=>e.section.id===section.id)||n.commandsByActiveSection.push({section:section,data:commands});let o=n.commandsByActiveSection.find(e=>e.section.id===section.id);(!n.filteredSectionId||n.filteredSectionId===section.id)&&o&&0===o.data.length&&0!==commands.length&&(o.data=commands);let i=n.sectionDescriptors.filter(e=>"-1"===e.id);i.length>1&&(n.sectionDescriptors=n.sectionDescriptors.filter(e=>"-1"!==e.id),n.sectionDescriptors.push(i.find(e=>"-1"===e.id)))}),Patcher$3.after(Assets,"getApplicationIconURL",(e,[t],n)=>{if("enmity"===t.id)return section.icon})}var Commands$2=Object.freeze({__proto__:null,section:section,registerCommands:registerCommands,unregisterCommands:unregisterCommands});const replies={};function sendCommand(e,t=[],n){let r=uuid();Linking.openURL(`com.hammerandchisel.discord://enmity?id=${r}&command=${e}&params=${t.join(",")}`).then(()=>{n&&(replies[r]=n)})}Linking.addEventListener("url",e=>{let t=e.url;t=decodeURIComponent(t.replace("com.hammerandchisel.discord://",""));try{let n=JSON.parse(t);if(void 0===n.data)return;replies[n.id]&&(replies[n.id](n.data),delete replies[n.id])}catch(r){return}});const EventEmitter$1=getByProps("EventEmitter").EventEmitter;let plugins$1=[],enabled=window.plugins.enabled,disabled=window.plugins.disabled;const Events$1=new EventEmitter$1;function registerPlugin(e){e&&"object"==typeof e&&(e.onEnable=()=>{try{e.onStart(),e.commands&&registerCommands(e.name,e.commands),console.log(`${e.name} has been enabled`)}catch(t){console.log(`${e.name} failed to load`,t.message)}},e.onDisable=()=>{try{if(e.patches)for(let t of e.patches)t.unpatchAll();e.commands&&unregisterCommands(e.name),e.onStop(),console.log(`${e.name} has been disabled`)}catch(n){console.log(`${e.name} failed to disable`,n.message)}},enabled.includes(e.name)&&e.onEnable(),disabled.includes(e.name)&&e.onDisable(),getPlugin(e.name)||plugins$1.push(e))}const on$1=Events$1.on.bind(Events$1),once$1=Events$1.once.bind(Events$1),off$1=Events$1.off.bind(Events$1);function getPlugin(e){return plugins$1.find(t=>t.name===e)}function getPlugins(){return plugins$1}function getEnabledPlugins(){return enabled}function getDisabledPlugins(){return disabled}function disablePlugin$1(e,t=!1,n){if(enabled.includes(e)){let r=enabled.indexOf(e);~r&&enabled.splice(r,1)}if(t&&disabled.includes(e)){let o=disabled.indexOf(e);~o&&disabled.splice(o,1)}return t||disabled.push(e),getPlugin(e).onDisable(),new Promise(t=>{sendCommand("disable-plugin",[e],(...e)=>{n&&n(...e),t(...e)})})}function enablePlugin(e,t){if(disabled.includes(e)){let n=disabled.indexOf(e);~n&&disabled.splice(n,1)}return enabled.push(e),getPlugin(e).onEnable(),new Promise(n=>{sendCommand("enable-plugin",[e],(...e)=>{t&&t(...e),n(...e)})})}async function evalPlugin(url,enable=!1,update){try{let response=await REST.get(url),code=response.text,name=url.split("/").pop().split(".")[0],id=Number(Object.keys(window.modules).pop())+1,wrapper=`__d(function(...args) {
        try {
          ${code}
        } catch(err) {
          console.log(err);
        }
      }, ${id}, []);
      __r(${id})`;try{eval(wrapper),enable&&!enabled.includes(name)&&await enablePlugin(name)}catch(e){console.log("Failed to eval plugin instance",e.message)}return update&&update(),name}catch(e){console.log("Failed to eval plugin instance",e.message)}}function installPlugin(e,t,n){let r=e.split("/").pop().split(".")[0];return new Promise(o=>{sendCommand("install-plugin",[e],i=>{function a(){evalPlugin(e,!0).then(r=>{let a={name:r,data:i,url:e};Events$1.emit("installed"),t&&t(a),n(),o(a)})}return"overridden_plugin"===i?disablePlugin$1(r,!0).then(a):a()})})}function uninstallPlugin(e,t){return new Promise(n=>{disablePlugin$1(e),sendCommand("uninstall-plugin",[e],r=>{enabled=enabled.filter(t=>t!==e),disabled=disabled.filter(t=>t!==e);let o=plugins$1.findIndex(t=>t.name===e);o>-1&&plugins$1.splice(o,1),Events$1.emit("uninstalled"),t&&t(r),n(r)})})}var Plugins=Object.freeze({__proto__:null,registerPlugin:registerPlugin,on:on$1,once:once$1,off:off$1,getPlugin:getPlugin,getPlugins:getPlugins,getEnabledPlugins:getEnabledPlugins,getDisabledPlugins:getDisabledPlugins,disablePlugin:disablePlugin$1,enablePlugin:enablePlugin,evalPlugin:evalPlugin,installPlugin:installPlugin,uninstallPlugin:uninstallPlugin});const{ThemeColorMap:ThemeColorMap$5}=ColorMap;function Authors({authors:e}){if(!e||!Array.isArray(e)||!e.length)return null;let t=StyleSheet$1.createThemedStyleSheet({linkless:{color:ThemeColorMap$5.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",fontSize:16,alignItems:"center",alignSelf:"center",justifyContent:"center"},link:{color:ThemeColorMap$5.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",alignItems:"center",fontSize:16,alignSelf:"center",justifyContent:"center"}});return React.createElement(View,{style:t.container},e.map((n,r)=>{let o=r!==e.length-1;return"string"==typeof n?React.createElement(Text,{style:t.linkless},n,o&&","):"object"==typeof n&&n.name&&!n.id?React.createElement(Text,{style:t.linkless},n.name,o&&","):"object"==typeof n&&n.name&&n.id?React.createElement(TouchableOpacity,{key:n.id,onPress:()=>Profiles.showUserProfile({userId:n.id})},React.createElement(Text,{style:t.link},n.name,o&&",")):null}).filter(Boolean))}const{createThemedStyleSheet:createThemedStyleSheet$1}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$4}=ColorMap;function PluginCard({plugin:e}){let t=getEnabledPlugins(),[n,r]=React.useState(t.includes(e.name)),o=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$4.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:e.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$4.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$4.HEADER_SECONDARY,fontSize:16,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5,marginRight:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$4.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center",flexWrap:"wrap",width:"100%"},delete:{marginRight:7.5},trashIcon:{width:22,height:22,tintColor:ThemeColorMap$4.INTERACTIVE_NORMAL},settingsIcon:{width:22,height:22,tintColor:ThemeColorMap$4.INTERACTIVE_NORMAL}}),i=e.getSettingsPanel;return React.createElement(View,{style:o.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:o.info},React.createElement(Text,{adjustsFontSizeToFit:!0,style:o.name},e.name),e.version&&React.createElement(Text,{adjustsFontSizeToFit:!0,style:o.version},e.version," ",e.authors&&"by"),React.createElement(Authors,{authors:e.authors})),trailing:()=>React.createElement(View,{style:o.actions},i&&React.createElement(TouchableOpacity,{style:o.delete,onPress(){Navigation.push(PluginSettings,{name:e.name,children:connectComponent(i,e.name)})}},React.createElement(Image,{style:o.settingsIcon,source:Assets$1.getIDByName("settings")})),React.createElement(TouchableOpacity,{style:o.delete,onPress:()=>void uninstallPlugin(e.name)},React.createElement(Image,{style:o.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:n,onValueChange(t){r(t),Toasts.open({content:`${e.name} has been ${t?"enabled":"disabled"}.`}),t?enablePlugin(e.name):disablePlugin$1(e.name)}}))})),React.createElement(View,{style:o.content},React.createElement(Text,{style:o.description},e.description??"No description provided.")))}function HeaderRight$2(){let e=createThemedStyleSheet$1({header:{tintColor:ThemeColorMap$4.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:e.wrapper,async onPress(){let e=await Clipboard.getString();Alert.prompt("Install a plugin","Please enter the URL of the plugin to install.",e=>{if(!e.endsWith("js"))return Toasts.open({content:"Invalid URL for plugin",source:Assets$1.getIDByName("ic_close_16px")});installPlugin(e,({data:e})=>{let t={icon:null,text:null};switch(e){case"fucky_wucky":t.text="Failed plugin installation.",t.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_plugin":t.text="Plugin has been installed.",t.icon=Assets$1.getIDByName("Check");break;case"overridden_plugin":t.text="Plugin has been overriden.",t.icon=Assets$1.getIDByName("Check")}Toasts.open({content:t.text,source:t.icon})})},void 0,e.endsWith(".js")?e:null)}},React.createElement(Image,{style:e.header,source:Assets$1.getIDByName("add_white")}))}const Search$1=getModule(e=>"StaticSearchBarContainer"===e.name);function Page$2(){let e=React.useState(null)[1],[t,n]=React.useState(getPlugins().sort((e,t)=>e.name.localeCompare(t.name))),[r,o]=React.useState(!1),[i,a]=React.useState(null);React.useEffect(()=>{function t(){e({})}return on$1("installed",t),on$1("uninstalled",t),()=>{off$1("installed",t),off$1("uninstalled",t)}},[]);let l=i?t.filter(e=>!!(e.name.toLowerCase().includes(i.toLowerCase())||e.description?.toLowerCase().includes(i.toLowerCase())||e.authors?.find?.(e=>(e.name??e).toLowerCase().includes(i.toLowerCase())))):t,s=createThemedStyleSheet$1({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$4.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{margin:0,marginBottom:0,paddingBottom:5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0,background:"none"}});return React.createElement(React.Fragment,null,React.createElement(Search$1,{style:s.search,placeholder:"Search plugins...",onChangeText:e=>a(e)}),React.createElement(View,{style:s.container},React.createElement(ScrollView,{style:s.container,refreshControl:React.createElement(RefreshControl,{refreshing:r,onRefresh(){o(!0),n(getPlugins()),o(!1)}})},l.length?l.map(e=>React.createElement(PluginCard,{plugin:e})):i?React.createElement(View,{style:s.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:s.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...s.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:s.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:s.notFoundText},"You don't have any plugins."),React.createElement(Text,{style:{...s.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}let theme=window.themes?.theme??"",themes$1=window.themes?.list??[];const EventEmitter=getByProps("EventEmitter").EventEmitter,Events=new EventEmitter,on=Events.on.bind(Events),once=Events.once.bind(Events),off=Events.off.bind(Events);function getTheme(){return theme}function getThemeByName(e){return themes$1.find(t=>t.name===e)}function listThemes(){return themes$1}async function installTheme(e,t){return new Promise(n=>{sendCommand("install-theme",[e],r=>{REST.get(e).then(o=>{let i=JSON.parse(o.text);if(!i)throw Error("Invalid theme structure");let a=themes$1.findIndex(e=>e.name===i.name);a>-1&&themes$1.splice(a,1),themes$1.push(i);let l={theme:i,url:e,data:r,restart:getTheme()===i.name};t&&t(l),Events.emit("installed"),n(l)})})})}function applyTheme(e,t){return new Promise(n=>{sendCommand("apply-theme",[e,Theme.theme],r=>{theme=e,t&&t(r),Events.emit("applied",e),n(r)})})}function removeTheme(e){return new Promise(t=>{sendCommand("remove-theme",[],n=>{theme="",e&&e(n),Events.emit("removed"),t(n)})})}async function uninstallTheme(e,t){return getTheme()===e&&removeTheme(),new Promise(n=>{sendCommand("uninstall-theme",[e],r=>{let o=themes$1.findIndex(t=>t.name===e);o>-1&&themes$1.splice(o,1),Events.emit("uninstalled"),t&&t(r),n(r)})})}var Themes=Object.freeze({__proto__:null,on:on,once:once,off:off,getTheme:getTheme,getThemeByName:getThemeByName,listThemes:listThemes,installTheme:installTheme,applyTheme:applyTheme,removeTheme:removeTheme,uninstallTheme:uninstallTheme});const reload=Native.BundleUpdaterManager.reload,version=Native.InfoDictionaryManager.Version,os=Native.DCDDeviceManager.systemVersion,build=Native.InfoDictionaryManager.Build,device=Native.DCDDeviceManager.device,{createThemedStyleSheet}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$3}=ColorMap;function ThemeCard({theme:e}){let t=getTheme(),[n,r]=React.useState(t===e.name),o=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$3.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:e.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$3.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$3.HEADER_SECONDARY,fontSize:16,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5,marginRight:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$3.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center",flexWrap:"wrap",width:"100%"},delete:{marginRight:7.5},trashIcon:{width:22,height:22,tintColor:ThemeColorMap$3.INTERACTIVE_NORMAL}});return React.createElement(View,{style:o.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:o.info},React.createElement(Text,{adjustsFontSizeToFit:!0,style:o.name},e.name),e.version&&React.createElement(Text,{adjustsFontSizeToFit:!0,style:o.version},e.version," ",e.authors&&"by"),React.createElement(Authors,{authors:e.authors})),trailing:()=>React.createElement(View,{style:o.actions},React.createElement(TouchableOpacity,{style:o.delete,onPress(){uninstallTheme(e.name,()=>{n&&Dialog.show({title:"Theme Uninstalled",body:"Uninstalling the theme you previously had applied requires a restart, would you like to restart Discord to remove the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reload})})}},React.createElement(Image,{style:o.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:n,onValueChange(t){r(t),Toasts.open({content:`${e.name} has been ${t?"enabled":"disabled"}.`}),t?(applyTheme(e.name),Dialog.show({title:"Theme Applied",body:"Applying a theme requires a restart, would you like to restart Discord to apply the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reload})):(removeTheme(),Dialog.show({title:"Theme Removed",body:"Removing the applied theme requires a restart, would you like to restart Discord to remove the applied theme?",confirmText:"Yes",cancelText:"No",onConfirm:reload}))}}))})),React.createElement(View,{style:o.content},React.createElement(Text,{style:o.description},e.description??"No description provided.")))}function HeaderRight$1(){let e=createThemedStyleSheet({header:{tintColor:ThemeColorMap$3.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:e.wrapper,async onPress(){let e=await Clipboard.getString();Alert.prompt("Install a theme","Please enter the URL of a theme to install.",e=>{if(!e.endsWith("json"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});try{installTheme(e,({data:e,restart:t})=>{let n={icon:null,text:null,restart:!1};switch(e){case"fucky_wucky":n.text="Failed theme installation.",n.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_theme":n.text="Theme has been installed.",n.icon=Assets$1.getIDByName("Check"),n.restart=t;break;case"overridden_theme":n.text="Theme has been overriden.",n.icon=Assets$1.getIDByName("Check"),n.restart=t}if(Toasts.open({content:n.text,source:n.icon}),n.restart)return Dialog.show({title:"Theme Replaced",body:"Replacing the theme you previously had applied requires a restart, would you like to restart Discord to reload the theme values?",confirmText:"Yes",cancelText:"No",onConfirm:reload})})}catch(t){Toasts.open({content:t.message})}},void 0,e.endsWith(".json")?e:null)}},React.createElement(Image,{style:e.header,source:Assets$1.getIDByName("add_white")}))}const Search=getModule(e=>"StaticSearchBarContainer"===e.name);function Page$1(){let e=React.useState(null)[1],[t,n]=React.useState(listThemes().sort((e,t)=>e.name.localeCompare(t.name))),[r,o]=React.useState(!1),[i,a]=React.useState(null);React.useEffect(()=>{function t(){e({})}return on("installed",t),on("uninstalled",t),()=>{off("installed",t),off("uninstalled",t)}},[]);let l=i?t.filter(e=>!!(e.name.toLowerCase().includes(i.toLowerCase())||e.description?.toLowerCase().includes(i.toLowerCase())||e.authors?.find?.(e=>(e.name??e).toLowerCase().includes(i.toLowerCase())))):t,s=createThemedStyleSheet({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$3.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{margin:0,marginBottom:0,paddingBottom:5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0,background:"none"}});return React.createElement(React.Fragment,null,React.createElement(Search,{style:s.search,placeholder:"Search themes...",onChangeText:e=>a(e)}),React.createElement(View,{style:s.container},React.createElement(ScrollView,{style:s.container,refreshControl:React.createElement(RefreshControl,{refreshing:r,onRefresh(){o(!0),n(listThemes()),o(!1)}})},l.length?l.map(e=>React.createElement(ThemeCard,{theme:e})):i?React.createElement(View,{style:s.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:s.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...s.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:s.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:s.notFoundText},"You don't have any themes."),React.createElement(Text,{style:{...s.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}function _extends$1(){return(_extends$1=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const{ThemeColorMap:ThemeColorMap$2}=ColorMap;function PluginIcon({height:e,width:t,...n}){let r=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$2.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,_extends$1({viewBox:"0 0 24 24",style:{height:e,width:t,...r.icon},fill:"currentColor"},n),React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const{ThemeColorMap:ThemeColorMap$1}=ColorMap;function ThemeIcon({height:e,width:t,...n}){let r=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$1.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,_extends({viewBox:"0 0 24 24",style:{height:e,width:t,...r.icon},fill:"currentColor"},n),React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}const ThemeColorMap=ColorMap.ThemeColorMap,Invites=getByProps("acceptInviteAndTransitionToInviteChannel");function HeaderRight(){return null}function Page({settings:e}){let t=StyleSheet$1.createThemedStyleSheet({debugText:{color:ThemeColorMap.TEXT_MUTED}}),n={Twitter:getIDByName("img_account_sync_twitter_white"),GitHub:getIDByName("img_account_sync_github_white"),Addon:getIDByName("img_nitro_increase_guild_limit"),Checkmark:getIDByName("Check"),Discord:getIDByName("Discord"),Refresh:getIDByName("ic_sync_24px")},r=[...window.plugins.enabled,...window.plugins.disabled],o=listThemes().map(e=>e.name);return React.createElement(ScrollView,null,React.createElement(KeyboardAvoidingView,{enabled:!0,behavior:"position",style:t.container,keyboardVerticalOffset:100,contentContainerStyle:{backfaceVisibility:"hidden"}},React.createElement(FormSection,{title:"Links"},React.createElement(FormRow,{label:"Discord Server",leading:React.createElement(FormRow.Icon,{source:n.Discord}),trailing:FormRow.Arrow,onPress:()=>Invites.acceptInviteAndTransitionToInviteChannel("enmityapp")}),React.createElement(FormRow,{label:"GitHub",leading:React.createElement(FormRow.Icon,{source:n.GitHub}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://github.com/enmity-mod")}),React.createElement(FormRow,{label:"Twitter",leading:React.createElement(FormRow.Icon,{source:n.Twitter}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://twitter.com/EnmityApp")})),React.createElement(FormSection,{title:"Debug"},React.createElement(FormRow,{label:"Discord Version",leading:React.createElement(FormRow.Icon,{source:n.Discord}),trailing:()=>React.createElement(Text,{style:t.debugText},version),onPress(){Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(version)}}),React.createElement(FormRow,{label:"Enmity Version",leading:React.createElement(FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:()=>React.createElement(Text,{style:t.debugText},window.enmity.version),onPress:()=>Linking.openURL(`https://github.com/enmity-mod/enmity/commit/${window.enmity.version}`)}),React.createElement(FormRow,{label:"Installed Plugins",leading:React.createElement(PluginIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:t.debugText},r.length),onPress(){Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(`**Plugins**: ${r.join(", ")}`)}}),React.createElement(FormRow,{label:"Installed Themes",leading:React.createElement(ThemeIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:t.debugText},o.length),onPress(){Toasts.open({content:"Copied to clipboard",source:n.Checkmark}),Clipboard.setString(`**Themes**: ${o.join(", ")}`)}}),React.createElement(FormRow,{label:"Reload Discord",leading:React.createElement(FormRow.Icon,{source:n.Refresh}),onPress(){Dialog.show({title:"Are You Sure?",body:"Are you sure you want to reload the discord app? This might crash your app instead of reloading it.",confirmText:"Yes",cancelText:"No",onConfirm:reload})}}),React.createElement(FormRow,{label:"Automatically connect to debug websocket",trailing:React.createElement(FormSwitch,{value:e.getBoolean("autoConnectWS",!1),onValueChange(){e.toggle("autoConnectWS",!1),e.get("autoConnectWS",!1)?connectWebsocket():socket.close()}})}),e.getBoolean("autoConnectWS",!1)&&React.createElement(FormInput,{value:e.get("debugWSAddress","192.168.0.1:9090"),onChange:t=>e.set("debugWSAddress",t),title:"DEBUG IP"}))))}const Patcher$2=create("enmity-settings");function patchSettings(){patchScreens(),patchSettings$1()}function patchScreens(){Patcher$2.after(Scenes,"default",(e,t,n)=>({...n,Enmity:{key:"Enmity",title:"Enmity",render:connectComponent(Page,"enmity"),headerRight:HeaderRight},EnmityPlugins:{key:"EnmityPlugins",title:"Plugins",render:Page$2,headerRight:HeaderRight$2},EnmityThemes:{key:"EnmityThemes",title:"Themes",render:Page$1,headerRight:HeaderRight$1}}))}function patchSettings$1(){let e=getByTypeName("UserSettingsOverviewWrapper",{default:!1}),t=Patcher$2.after(e,"default",(e,n,r)=>{let o=findInReactTree(r,e=>e.type?.name==="UserSettingsOverview");Patcher$2.after(o.type.prototype,"render",({props:{navigation:e}},t,n)=>{let{children:r}=n.props,o=[Locale.Messages.BILLING_SETTINGS,Locale.Messages.PREMIUM_SETTINGS],i=r.findIndex(e=>o.includes(e.props.title));r.splice(-1===i?4:i,0,React.createElement(React.Fragment,null,React.createElement(FormSection,{key:"Enmity",title:"Enmity"},React.createElement(FormRow,{label:"General",leading:React.createElement(FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:React.createElement(FormArrow,null),onPress:()=>void e.push("Enmity",{navigation:e})}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Plugins",leading:React.createElement(PluginIcon,{width:24,height:24}),trailing:React.createElement(FormArrow,null),onPress:()=>void e.push("EnmityPlugins",{navigation:e})}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Themes",leading:React.createElement(ThemeIcon,{width:24,height:24}),trailing:React.createElement(FormArrow,null),onPress:()=>void e.push("EnmityThemes",{navigation:e})}))))}),t()})}const Patcher$1=create("no-track");function patchTracking(){let[e,t,n]=getByProps(["trackWithMetadata"],["AnalyticsActionHandlers"],["encodeProperties","track"],{bulk:!0});try{patchMetadata(e)}catch(r){console.error("Failed to patch metadata",r.message)}try{patchAnalytics(t)}catch(o){console.error("Failed to patch analytics",o.message)}try{patchProperties(n)}catch(i){console.error("Failed to patch properties",i.message)}return Patcher$1.unpatchAll}function patchMetadata(e){Patcher$1.instead(e,"trackWithMetadata",()=>{}),Patcher$1.instead(e,"trackWithGroupMetadata",()=>{})}function patchAnalytics(e){Patcher$1.instead(e.AnalyticsActionHandlers,"handleTrack",()=>{})}function patchProperties(e){Patcher$1.instead(e,"track",()=>{})}const BadgesDomain="https://raw.githubusercontent.com/enmity-mod/badges/main/";!function(e){e[e.HOUR=36e5]="HOUR"}(Times||(Times={}));const Patcher=create("badges"),cache={user:{},badges:{}};function patchBadges(){let e=getByDisplayName("ProfileBadges",{default:!1});return Patcher.after(e,"default",(t,[{user:n,isEnmity:r,...o}],i)=>{if(r)return;let[a,l]=React.useState([]);return React.useEffect(()=>{try{fetchUserBadges(n.id).then(l)}catch(e){console.error(`Failed to request/parse badges for ${n.id}`)}},[]),a.length&&(!i&&(i=wrapInHooks(e.default)({user:new Proxy({},{get:(e,t)=>"flags"===t?-1:n[t]}),isEnmity:!0,...o}))?.props&&(i.props.badges=[]),i&&i.props.badges.push(...a.map(e=>React.createElement(View,{key:e,__enmity:!0,style:{alignItems:"center",flexDirection:"row",justifyContent:"flex-end"}},React.createElement(Badge,{type:e}))))),i}),Patcher.unpatchAll}async function fetchUserBadges(e){if(cache.user[e]?.date&&Date.now()-cache.user[e].date<Times.HOUR)return cache.user[e].badges;let t=await fetch(BadgesDomain+e+".json",{headers:{"Cache-Control":"no-cache"}}).then(e=>e.json()).catch(()=>[]);return Array.isArray(t)&&(cache.user[e]={badges:t,date:Date.now()}),t}function Badge({type:e}){let[t,n]=React.useState(null);return(React.useEffect(()=>{try{fetchBadge(e).then(n)}catch(t){console.error(`Failed to get badge data for ${e}.`,t.message)}},[]),t?.url)?React.createElement(TouchableOpacity,{onPress(){Toasts.open({content:t.name,source:{uri:t.url[Theme.theme]}})}},React.createElement(Image,{source:{uri:t.url[Theme.theme]},style:{width:24,height:24,resizeMode:"contain",marginHorizontal:2}})):null}async function fetchBadge(e){if(cache.badges[e]?.date&&Date.now()-cache.badges[e].date<Times.HOUR)return cache.badges[e].data;let t=await fetch(BadgesDomain+`data/${e}.json`,{headers:{"Cache-Control":"no-cache"}}).then(e=>e.json()).catch(()=>{});return t?.url&&(cache.badges[e]={data:t,date:Date.now()}),t}function initialize$3(){try{patchSettings()}catch(e){console.log("Failed to patch settings: ",e.message)}try{patchTracking()}catch(t){console.log("Failed to patch trackers: ",t.message)}try{patchBadges()}catch(n){console.log("Failed to patch badges: ",n.message)}}var CorePatches={initialize:initialize$3};const Channels=getByProps("getLastSelectedChannelId");try{Avatars.BOT_AVATARS.ENMITY="https://github.com/enmity-mod.png"}catch{}function sendReply(e,t,n,r){let o=e??Channels?.getChannelId?.(),i=Clyde$1.createBotMessage({channelId:o,content:""});i.author.username=n??"Enmity",i.author.avatar=r?n:"ENMITY",r&&(Avatars.BOT_AVATARS[n]=r),"string"==typeof t?i.content=t:Object.assign(i,t),Messages.receiveMessage(o,i)}var Clyde=Object.freeze({__proto__:null,sendReply:sendReply}),plugins=[{name:"plugins list",description:"List installed plugins",execute(e,t){let n=t.channel.id,r=getPlugins();if(0===r.length){sendReply(n,"No plugins installed.");return}let o=getEnabledPlugins(),i=getDisabledPlugins(),a="";o.length>0&&(a=`**Enabled plugins (${o.length})**:
`,a+=`> ${o.join(", ")}
`),i.length>0&&(a+=`**Disabled plugins (${i.length})**:
`,a+=`> ${i.join(", ")}`),sendReply(n,a)}},{name:"plugins install",description:"Install a plugin",options:[{name:"plugin",displayName:"plugin",description:"Plugin url",displayDescription:"Plugin url",required:!0,type:ApplicationCommandOptionType.String},],execute(e,t){let n=e[0].value,r=t.channel.id;installPlugin(n,e=>{sendReply(r,e)})}},{name:"plugins uninstall",description:"Uninstall a plugin",options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(e,t){let n=e[0].value,r=t.channel.id;uninstallPlugin(n,e=>{sendReply(r,e)})}},{name:"plugins disable",description:"Disable a plugin",options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(e,t){let n=e[0].value,r=t.channel.id;disablePlugin(n,e=>{if("yes"===e){sendReply(r,`**${n}** has been disabled.`);return}sendReply(r,`Error when disabling **${n}**.`)})}},{name:"plugins enable",description:"Enable a plugin",options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(e,t){let n=e[0].value,r=t.channel.id;enablePlugin(n,e=>{if("yes"===e){sendReply(r,`**${n}** has been enabled.`);return}sendReply(r,`Error when enabling **${n}**.`)})}}],themes=[{name:"themes list",description:"List available themes",execute(e,t){let n=listThemes();if(0===n.length){sendReply(t.channel.id,"No themes installed.");return}sendReply(t.channel.id,`**Installed themes (${n.length})**: ${n.map(e=>e.name).join(", ")}`)}},{name:"themes apply",description:"Apply a theme",options:[{name:"name",displayName:"name",description:"Theme's name",displayDescription:"Theme's name",type:ApplicationCommandOptionType.String,required:!0,choices:listThemes().map(e=>({name:e.name,displayName:e.name,value:e.name}))},],execute(e,t){let n=e[0].value,r=getThemeByName(n);r||sendReply(t.channel.id,"Theme couldn't be found."),applyTheme(n).then(e=>{sendReply(t.channel.id,e)})}},{name:"themes clear",description:"Remove applied theme",execute(e,t){removeTheme().then(e=>{sendReply(t.channel.id,e)})}}],utils=[{name:"debug",description:"Print out your device information",execute(e,t){let n=[];n.push("**Debug Info:**"),n.push(`> Enmity: ${window.enmity.version}`),n.push(`> Discord: ${version} (${build})`),n.push(`> Device: ${device}`),n.push(`> System: ${os}`),Messages.sendMessage(t.channel.id,{validNonShortcutEmojis:[],content:n.join("\n")})}},{name:"reload",description:"Reload Discord",execute:reload},{name:"token",description:"Show your Discord's token",execute:function(e,t){sendReply(t.channel.id,Token.getToken())}},],websocket=[{name:"websocket",description:"Connect to the websocket server",options:[{name:"host",displayName:"host",description:"Host of the debugger",displayDescription:"Host of the debugger",type:ApplicationCommandOptionType.String,required:!0},],execute(e){let t=e[0].value;connectWebsocket(t)}},{name:"dump",description:"Dump Discord's modules",execute(e,t){let n=t.channel.id,r=window.modules;function o(e){if("function"==typeof e)return e.toString();if(Array.isArray(e))return e.map(o);if("object"==typeof e){let t={};for(let n in e)t[n]=o(e[n]);return t}return e}for(let i of Object.keys(r))try{let a=r[i],l={id:i};if(!a.publicModule?.exports)continue;let s=a.publicModule.exports;for(let c of Object.keys(a.publicModule.exports))l[c]=o(s[c]);sendMessage(JSON.stringify(l,null,"	"))}catch(u){console.log(`Couldn't dump module ${i}`),console.log(u)}sendReply(n,"Modules has been dumped.")}},];function initialize$2(){let e=[...plugins,...websocket,...utils,...themes,];registerCommands("enmity",e)}var Commands={initialize:initialize$2};const API={modules:Modules,themer:Themes,patcher:Patcher$5,version:"a169229",plugins:Plugins,clyde:Clyde,commands:Commands$2,utilities:Utilities,settings:Settings$2,components:Components,native:Native,assets:Assets$2};function initialize$1(){window.enmity=API}var API$1={API,initialize:initialize$1};function initialize(){WebSocket$1.initialize(),API$1.initialize(),CorePatches.initialize(),Commands.initialize()}var index={initialize},index$1=Object.freeze({__proto__:null,initialize:initialize,default:index});
