const modules$1={Constants:{props:["ActionTypes"]},Clipboard:{props:["setString","getString"]},Assets:{props:["registerAsset"]},Messages:{props:["receiveMessage","sendMessage"]},Clyde:{props:["createBotMessage"]},Avatars:{props:["BOT_AVATARS"]},Native:{props:["NativeModules"],export:"NativeModules"},React:{props:["createElement"]},Dispatcher:{props:["dirtyDispatch"]},Storage:{props:["getItem"]},Toasts:{props:["open","close"],ensure:a=>!a.openLazy&&!a.startDrag&&!a.init&&!a.openReplay},Dialog:{props:["show","openLazy","open","close"]},Token:{props:["getToken"]},REST:{props:["getAPIBaseURL"]},Settings:{props:["watchKeys"]},Users:{props:["getCurrentUser"]},Subscriptions:{props:["getPremiumTypeSubscription"]},Navigation:{props:["pushLazy"]},NavigationNative:{props:["NavigationContainer"]},NavigationStack:{props:["createStackNavigator"]},Theme:{props:["theme"]},Linking:{props:["openURL"]},StyleSheet:{props:["createThemedStyleSheet"]},ColorMap:{props:["ThemeColorMap"]},Components:{multiple:!0,props:{Forms:["Form","FormSection"],General:["Button","Text","View"]}},Locale:{props:["Messages"]},Profiles:{props:["showUserProfile"]},Lodash:{props:["debounce","throttle"]},Logger:{name:"Logger"},Flux:{props:[["Store","connectStores"],["useStateFromStoresObject"]]},SVG:{props:["Svg"]},Scenes:{name:"getScreens",default:!1}},common={},blacklist$1=[a=>a>=951&&a<=1006,125,203,433,434,445,446,457,],filters={byProps:(...a)=>b=>a.every(a=>void 0!==b[a]),byName:(a,b=!0)=>c=>!!c&&(b?"function"==typeof c&&c.name===a:"function"==typeof c.default&&c.default.name===a),byTypeName:(a,b=!0)=>c=>!!c&&(b?"function"==typeof c&&c.name===a:"function"==typeof c.default&&c.default.type?.name===a),byDisplayName:(a,b=!0)=>c=>!!c&&(b?"function"==typeof c&&c.name===a:"function"==typeof c.default&&c.default.name===a)},getters=[];Object.entries(modules$1).map(([b,a])=>{if(a.multiple)Object.entries(a.props).map(([a,c])=>{getters.push({id:a,filter(a){let b=filters.byProps(...c)(a);return b},submodule:b})});else if(a.props){if(a.props.every(a=>Array.isArray(a))){let c=[];getters.push({id:b,filter(d){let b=a.props.some(a=>a.every(a=>d[a]));return(!b||!a.ensure||!!a.ensure(d))&&(b&&c.push(d),b)},map:Object.assign({},...c)})}else getters.push({id:b,filter(b){let c=filters.byProps(...a.props)(b);return(!c||!a.ensure|| !1!==a.ensure(b))&&c},map:a.export})}else a.displayName?getters.push({id:b,filter:filters.byDisplayName(a.displayName,a.default),map:a.export}):a.name?getters.push({id:b,filter:filters.byName(a.name,a.default),map:a.export}):a.filter&&getters.push({id:b,filter:a.filter,map:a.export})});const results=bulk(...getters.map(({filter:a})=>a));function getModule(filter,{all=!1,traverse=!0,defaultExport=!0}={}){if("function"!=typeof filter)return null;let found=[],search=function(a,b){try{return filter(a,b)}catch{return!1}};for(let id in modules){if(blacklist$1.some(a=>"function"==typeof a?a(id):a===Number(id)))continue;modules[id].isInitialized||__r(Number(id));let mdl=modules[id].publicModule.exports;if(mdl&&mdl!==window){if("object"==typeof mdl){if(search(mdl,id)){if(!all)return mdl;found.push(mdl)}if(mdl.__esModule&&mdl.default&&search(mdl.default,id)){let value=defaultExport?mdl.default:mdl;if(!all)return value;found.push(value)}if(traverse&&mdl.__esModule){for(let key in mdl)if(void 0!==mdl[key]&&search(mdl[key],id)){if(!all)return mdl[key];found.push(mdl[key])}}}else if("function"==typeof mdl){if(!search(mdl,id))continue;if(!all)return mdl;found.push(mdl)}}}return all?found:found[0]}function getModules(filter){return getModule(filter,{all:!0})}function bulk(...filters1){let found=new Array(filters1.length),wrapped=filters1.map(a=>b=>{try{return a(b)}catch{return!1}});return getModule(b=>{for(let a=0;a<wrapped.length;a++){let c=wrapped[a];"function"==typeof c&&c(b)&&null==found[a]&&(found[a]=b)}return found.filter(String).length===filters1.length}),found}function getByProps(...options){let[props,{bulk:bulk1=!1,...rest}]=parseOptions(options);if(bulk1){let filters2=props.map(a=>Array.isArray(a)?filters2.byProps(...a):filters2.byProps(a)).concat({...rest});return bulk1(...filters2)}return getModule(filters.byProps(...props),rest)}function getByDisplayName(...options){let[names,{bulk:bulk2=!1,default:defaultExport=!0,...rest}]=parseOptions(options);if(bulk2){let bulked=names.map(filters.byDisplayName).concat({defaultExport,...rest});return bulk2(...bulked)}return getModule(filters.byDisplayName(names[0]),{defaultExport,...rest})}function getByTypeName(...options){let[names,{bulk:bulk3=!1,default:defaultExport=!0,...rest}]=parseOptions(options);if(bulk3){let bulked=names.map(filters.byTypeName).concat({defaultExport,...rest});return bulk3(...bulked)}return getModule(filters.byTypeName(names[0]),{defaultExport,...rest})}function getByName$1(...options){let[names,{bulk:bulk4=!1,default:defaultExport=!0,...rest}]=parseOptions(options);if(bulk4){let bulked=names.map(filters.byName).concat({defaultExport,...rest});return bulk4(...bulked)}return getModule(filters.byName(names[0]),{defaultExport,...rest})}function getByKeyword(...options){let[[keyword],{caseSensitive=!1,all=!1,...rest}]=parseOptions(options);return getModule(b=>{let c=[...Object.keys(b),...Object.keys(b.__proto__)];for(let a=0;a<c.length;a++){let d=c[a];if(caseSensitive){if(~d.indexOf(keyword))return!0}else{let e=keyword.toLowerCase();if(~d.toLowerCase().indexOf(e))return!0}}return!1},{all,...rest})}function parseOptions(args,filter=a=>"object"==typeof a&&!Array.isArray(a)){return[args,filter(args[args.length-1])?args.pop():{}]}getters.map(({id:c,map:d,submodule:a},f)=>{let b=a=>a;if("string"==typeof d)b=a=>a[d];else if(Array.isArray(d)){let g={};b=b=>{for(let a of d)g[a]=b[a];return g}}let e=b(results[f]);a?(common[a]??={},common[a][c]=e):common[c]=e});var Type,ApplicationCommandSectionType,ApplicationCommandType,ApplicationCommandInputType,ApplicationCommandPermissionType,ApplicationCommandOptionType,InteractionTypes,Modules=Object.freeze({__proto__:null,common:common,filters:filters,getModule:getModule,getModules:getModules,bulk:bulk,getByProps:getByProps,getByDisplayName:getByDisplayName,getByTypeName:getByTypeName,getByName:getByName$1,getByKeyword:getByKeyword});const{Clipboard,Assets:Assets$3,Messages,Clyde:Clyde$1,Avatars,Native,Dispatcher,Storage,Toasts,Dialog,Token,REST,Settings:Settings$3,Users,Theme,Linking,StyleSheet:StyleSheet$1,ColorMap,Components:Components$1,Locale,Constants,Profiles,Logger:Logger$1,Lodash,Flux,SVG,Scenes,Subscriptions,Navigation,NavigationNative,NavigationStack}=common;common.React;const patches$1=[];function getPatchesByCaller(id){if(!id)return[];let _patches=[];for(let entry of patches$1){let store=[...entry.patches.before,...entry.patches.instead,...entry.patches.after];for(let patch1 of store)patch1.caller===id&&_patches.push(patch1)}return _patches}function unpatchAll$1(caller){let patches1=getPatchesByCaller(caller);if(patches1.length)for(let patch2 of patches1)patch2.unpatch()}function override(patch3){return function(){if(!patch3?.patches?.before.length&&!patch3?.patches?.after.length&&!patch3?.patches?.instead.length&&!patches$1.find(a=>a.mdl===patch3.mdl&&a.func===patch3.func))return patch3.unpatch(),new.target?new patch3.original(...arguments):patch3.original.apply(this,arguments);let c,b=arguments,j=patch3.patches.before;for(let f=0;f<j.length;f++){let d=j[f];if(d)try{let k=d.callback(this,b,patch3.original.bind(this));Array.isArray(k)&&(b=k),d.once&&d.unpatch()}catch(o){console.error(`Could not fire before patch for ${patch3.func} of ${d.caller}`),console.error(o)}}let g=patch3.patches.instead;if(g.length)for(let h=0;h<g.length;h++){let e=g[h];if(e)try{let l=e.callback(this,b,patch3.original.bind(this));void 0!==l&&(c=l),e.once&&e.unpatch()}catch(p){console.error(`Could not fire instead patch for ${patch3.func} of ${e.caller}`),console.error(p)}}else c=new.target?new patch3.original(...b):patch3.original.apply(this,b);let m=patch3.patches.after;for(let i=0;i<m.length;i++){let a=m[i];if(a)try{a.caller.includes("downloader")&&console.log(a);let n=a.callback(this,b,c,a=>c=a);void 0!==n&&(c=n),a.once&&a.unpatch()}catch(q){console.error(`Could not fire after patch for ${patch3.func} of ${a.caller}`),console.error(q)}}return c}}function push$1([,mdl,func,,type,once]){let patch4={mdl,func,id:patches$1?.[type]?.length??0,original:mdl[func],once,unpatch(){patch4.mdl[patch4.func]=patch4.original,patch4.patches={before:[],after:[],instead:[]}},patches:{before:[],after:[],instead:[]}};mdl[func]=override(patch4);let descriptors=Object.getOwnPropertyDescriptors(patch4.original);return delete descriptors.length,Object.defineProperties(mdl[func],{...descriptors,toString:{value:()=>patch4.original.toString(),configurable:!0,enumerable:!1},__original:{value:patch4.original,configurable:!0,enumerable:!1}}),patches$1.push(patch4),patch4}function get$2([,mdl,func]){let patch5=patches$1.find(a=>a.mdl===mdl&&a.func===func);return patch5||push$1(...arguments)}function patch$1(caller,mdl,func,callback,type=Type.After,once=!1){if(caller&&"string"==typeof caller){if(mdl&&["function","object"].includes(typeof mdl)){if(func&&"string"==typeof func){if(callback&&"function"==typeof callback){if(type&&"string"==typeof type&&["after","before","instead"].includes(type)){if(void 0===mdl[func])throw new ReferenceError(`function ${func} does not exist on the second argument (object or function)`)}else throw new TypeError('fifth argument "type" must be of type string and any of the three: after, before, instead')}else throw new TypeError('fourth argument "callback" must be of type function')}else throw new TypeError('third argument "func" must be of type string')}else throw new TypeError('second argument "mdl" must be of type function or object')}else throw new TypeError('first argument "caller" must be of type string');let current=get$2(arguments),patch6={caller,once,type,id:current.patches?.[type]?.length??0,callback,unpatch(){let b=current.patches?.[type].findIndex(a=>a.id===patch6.id);if(~b&&current.patches?.[type].splice(b,1),current.patches?.before.length||current.patches?.after.length||current.patches?.instead.length)return;let a=patches$1.findIndex(a=>a.mdl==mdl&&a.func==func);a&&(patches$1[a]?.unpatch(),patches$1.splice(a,1))}};return current.patches[type]??=[],current.patches[type].push(patch6),patch6.unpatch}function before$1(caller,mdl,func,callback,once=!1){return patch$1(caller,mdl,func,callback,Type.Before,once)}function instead$1(caller,mdl,func,callback,once=!1){return patch$1(caller,mdl,func,callback,Type.Instead,once)}function after$1(caller,mdl,func,callback,once=!1){return patch$1(caller,mdl,func,callback,Type.After,once)}function create$1(name){return{getPatchesByCaller:getPatchesByCaller,before:(a,b,c)=>before$1(name,a,b,c),instead:(a,b,c)=>instead$1(name,a,b,c),after:(a,b,c)=>after$1(name,a,b,c),unpatchAll:()=>unpatchAll$1(name)}}!function(a){a.Before="before",a.Instead="instead",a.After="after"}(Type||(Type={}));var patcher={create:create$1,before:before$1,instead:instead$1,after:after$1,unpatchAll:unpatchAll$1,patches:patches$1},Patcher$4=Object.freeze({__proto__:null,create:create$1,before:before$1,instead:instead$1,after:after$1,unpatchAll:unpatchAll$1,patches:patches$1,default:patcher});const assets={};patcher.after("enmity-assets",Assets$3,"registerAsset",(c,[a],b)=>{assets[a.name]={...a,id:b}});for(let id=1;;id++){let asset=Assets$3.getAssetByID(id);if(!asset)break;assets[asset.name]||(assets[asset.name]={...asset,id})}function find(filter){return Object.values(assets).find(filter)}function getByName(name){return assets[name]}function getByID(id2){return Assets$3.getAssetByID(id2)}function getIDByName(name){return assets[name]?.id}var Assets$1={assets,getByName,getByID,getIDByName},Assets$2=Object.freeze({__proto__:null,assets:assets,find:find,getByName:getByName,getByID:getByID,getIDByName:getIDByName,default:Assets$1});const settings=Settings$3.get("enmity")??{};function getSetting(file,setting,defaults){return settings[file]?.[setting]??defaults}function get$1(file){return settings[file]??{}}function getAll(){return settings}const Events$2={ENMITY_GET_SETTING:({file:a,setting:b,defaults:c})=>settings[a][b]??c,ENMITY_SET_SETTING({file:a,setting:b,value:c}){settings[a]||(settings[a]={}),void 0==c?delete settings[a][b]:settings[a][b]=c},ENMITY_TOGGLE_SETTING({file:a,setting:b,defaults:c}){settings[a]||(settings[a]={}),void 0===settings[a][b]?settings[a][b]=!Boolean(c):settings[a][b]=!Boolean(settings[a][b])}},store=new Flux.Store(Dispatcher,Events$2);store.addChangeListener(Lodash.debounce(()=>Settings$3.set({enmity:settings}),200));var Manager={store,getAll,getSetting,get:get$1},React=common.React;const listeners={};function ENMITY_SET_SETTING(args){return handleSettingsUpdate({...args,type:"set"})}function ENMITY_TOGGLE_SETTING(args){return handleSettingsUpdate({...args,type:"toggle"})}function handleSettingsUpdate({file,type,...args}){let callbacks=listeners[file];if(callbacks)for(let callback of callbacks.values())callback({...args})}function set(file,setting,value){if(file&&"string"==typeof file){if(!setting||"string"!=typeof setting)throw new TypeError("the second argument setting must be of type string")}else throw new TypeError("the first argument file must be of type string");return Dispatcher.dirtyDispatch({type:"ENMITY_SET_SETTING",file,setting,value})}function get(file,setting,defaults){if(file&&"string"==typeof file){if(!setting||"string"!=typeof setting)throw new TypeError("the second argument setting must be of type string")}else throw new TypeError("the first argument file must be of type string");return Manager.getSetting(file,setting,defaults)}function getBoolean(file,setting,defaults){if(file&&"string"==typeof file){if(!setting||"string"!=typeof setting)throw new TypeError("the second argument setting must be of type string")}else throw new TypeError("the first argument file must be of type string");return Boolean(Manager.getSetting(file,setting,defaults))}function toggle(file,setting,defaults){if(file&&"string"==typeof file){if(setting&&"string"==typeof setting){if(void 0===defaults||"boolean"!=typeof defaults)throw new TypeError("the third argument defaults must be of type boolean")}else throw new TypeError("the second argument setting must be of type string")}else throw new TypeError("the first argument file must be of type string");return Dispatcher.dirtyDispatch({type:"ENMITY_TOGGLE_SETTING",file,setting,defaults})}function connectComponent(component,file){if(component&&["function","object"].includes(typeof component)){if(!file||"string"!=typeof file)throw new TypeError("the second argument file must be of type string")}else throw new TypeError("the first argument component must be of type function or object");let res=a=>{let b=React.useState({})[1];return React.useEffect(()=>{function a(){b({})}return subscribe(file,a),()=>unsubscribe(file,a)},[]),React.createElement(component,{...a,settings:makeStore(file)})};return component.displayName&&(res.displayName=component.displayName),component.name&&(res.name=`Connected${component.name}`),res}function makeStore(file){if(!file||"string"!=typeof file)throw new TypeError("the first argument file must be of type string");return{settings:Manager.get(file),set:(a,b)=>set(file,a,b),get:(a,b)=>get(file,a,b),toggle:(a,b)=>toggle(file,a,b),getBoolean:(a,b)=>getBoolean(file,a,b)}}function subscribe(file,callback){if(file&&"string"==typeof file){if(!callback||"function"!=typeof callback)throw new TypeError("the second argument callback must be of type function")}else throw new TypeError("the first argument file must be of type string");listeners[file]??=new Set,listeners[file].add(callback)}function unsubscribe(file,callback){if(file&&"string"==typeof file){if(!callback||"function"!=typeof callback)throw new TypeError("the second argument callback must be of type function")}else throw new TypeError("the first argument file must be of type string");listeners[file]?.delete(callback),listeners[file]?.size===0&&delete listeners[file]}function connectStores(file){return Flux.connectStores([Manager.store],()=>({settings:makeStore(file)}))}Dispatcher.subscribe("ENMITY_SET_SETTING",ENMITY_SET_SETTING),Dispatcher.subscribe("ENMITY_TOGGLE_SETTING",ENMITY_TOGGLE_SETTING);var Settings$1={connectComponent,connectStores,unsubscribe,subscribe,makeStore,listeners,toggle,get,set},Settings$2=Object.freeze({__proto__:null,listeners:listeners,set:set,get:get,getBoolean:getBoolean,toggle:toggle,connectComponent:connectComponent,makeStore:makeStore,subscribe:subscribe,unsubscribe:unsubscribe,connectStores:connectStores,default:Settings$1,settings:settings,store:store});const Logger=getByName$1("Logger"),EnmityLogger=new Logger("Enmity");let socket;function connectWebsocket(host){console.log("Connecting to debug WebSocket"),void 0!==socket&&socket.readyState!==WebSocket.CLOSED&&(socket.close(),socket=null);let address=Boolean(Settings$1.get("enmity","autoConnectWS",!1))&&Settings$1.get("enmity","debugWSAddress");(address||host)&&((socket=new WebSocket(`ws://${host??address}`)).addEventListener("open",()=>{console.log("Connected with debug websocket"),Toasts.open({content:"Connected to the websocket server."})}),socket.addEventListener("error",a=>{console.log(`Error with debug websocket: ${a.message}`),Toasts.open({content:"An error occured with the websocket connection, retrying in 1s."})}),socket.addEventListener("close",a=>{console.log(`Error with debug websocket: ${a.message}`),Toasts.open({content:"The websocket connection has been closed."})}),socket.addEventListener("message",message=>{try{console.log(eval(message.data))}catch(e){console.error(e)}}))}function initialize$4(){let oNativeLoggingHook=nativeLoggingHook;globalThis.nativeLoggingHook=function(a,b){return socket?.readyState===WebSocket.OPEN&&socket.send(JSON.stringify({level:b,message:a})),EnmityLogger.log(a),oNativeLoggingHook.apply(this,arguments)},Settings$1.get("enmity","autoConnectWS",!1)&&connectWebsocket()}function sendMessage(message){socket?.readyState===WebSocket.OPEN&&socket.send(message)}var WebSocket$1={initialize:initialize$4,sendMessage,connectWebsocket,socket};const AddonChannels={Plugins:["961782195767365732"],Themes:["961782176062509117","968223084643487744"]},Patcher$3=create$1("enmity-commands"),[Commands$1,Discovery,Assets]=bulk(filters.byProps("getBuiltInCommands"),filters.byProps("useApplicationCommandsDiscoveryState"),filters.byProps("getApplicationIconURL"));let commands=[];const section={id:"enmity",type:1,name:"Enmity",icon:"https://files.enmity.app/icon.png"};function registerCommands(caller,cmds){cmds.map(a=>{a.__enmity=!0,a.caller=caller}),commands.push(...cmds)}function unregisterCommands(caller){commands=commands.filter(a=>a.caller!==caller)}Patcher$3.after(Commands$1,"getBuiltInCommands",(b,c,a)=>[...a,...commands.values()]),Patcher$3.after(Assets,"getApplicationIconURL",(b,[a],c)=>{if("enmity"===a.id)return section.icon}),Patcher$3.after(Discovery,"useApplicationCommandsDiscoveryState",(f,[,,,e],a)=>{if(!1!==e)return a;if(!a.discoverySections.find(a=>a.key===section.id)&&commands.length){let b=[...commands.values()];a.discoveryCommands.push(...b),a.commands.push(...b.filter(b=>!a.commands.some(a=>a.name===b.name))),a.discoverySections.push({data:b,key:section.id,section}),a.sectionsOffset.push(commands.length)}!a.applicationCommandSections.find(a=>a.id===section.id)&&commands.length&&a.applicationCommandSections.push(section);let c=a.discoverySections.findIndex(a=>"-2"===a.key);if(a.discoverySections[c]?.data){let d=a.discoverySections[c];d.data=d.data.filter(a=>!a.__enmity),0===d.data.length&&a.discoverySections.splice(c,1)}});var Commands$2=Object.freeze({__proto__:null,section:section,registerCommands:registerCommands,unregisterCommands:unregisterCommands});function uuid(length=10){let uuid1="";do{let random=16*Math.random()|0;uuid1+=(12==uuid1.length?4:16==uuid1.length?3&random|8:random).toString(16)}while(uuid1.length<length)return uuid1}const replies={};function sendCommand(name,params=[],reply){let id=uuid();Linking.openURL(`com.hammerandchisel.discord://enmity?id=${id}&command=${name}&params=${params.join(",")}`).then(()=>{reply&&(replies[id]=reply)})}Linking.addEventListener("url",c=>{let b=c.url;b=decodeURIComponent(b.replace("com.hammerandchisel.discord://",""));try{let a=JSON.parse(b);if(void 0===a.data)return;replies[a.id]&&(replies[a.id](a.data),delete replies[a.id])}catch(d){return}});const EventEmitter$1=getByProps("EventEmitter").EventEmitter;let plugins$1=[],enabled=window.plugins.enabled,disabled=window.plugins.disabled;const Events$1=new EventEmitter$1;function registerPlugin(plugin){plugin&&"object"==typeof plugin&&(plugin.onEnable=()=>{try{plugin.onStart(),plugin.commands&&registerCommands(plugin.name,plugin.commands),console.log(`${plugin.name} has been enabled`)}catch(a){console.log(`${plugin.name} failed to load`,a.message)}},plugin.onDisable=()=>{try{if(plugin.patches)for(let a of plugin.patches)a.unpatchAll();plugin.commands&&unregisterCommands(plugin.name),plugin.onStop(),console.log(`${plugin.name} has been disabled`)}catch(b){console.log(`${plugin.name} failed to disable`,b.message)}},enabled.includes(plugin.name)&&plugin.onEnable(),disabled.includes(plugin.name)&&plugin.onDisable(),getPlugin(plugin.name)||plugins$1.push(plugin))}const on$1=Events$1.on.bind(Events$1),once$1=Events$1.once.bind(Events$1),off$1=Events$1.off.bind(Events$1);function getPlugin(name){return plugins$1.find(a=>a.name===name)}function getPlugins(){return plugins$1}function getEnabledPlugins(){return enabled}function getDisabledPlugins(){return disabled}function disablePlugin(name,onlyUnload=!1,callback){if(enabled.includes(name)){let idx=enabled.indexOf(name);~idx&&enabled.splice(idx,1)}if(onlyUnload&&disabled.includes(name)){let idx=disabled.indexOf(name);~idx&&disabled.splice(idx,1)}return onlyUnload||disabled.push(name),getPlugin(name).onDisable(),new Promise(a=>{sendCommand("disable-plugin",[name],(...b)=>{callback&&callback(...b),a(...b)})})}function enablePlugin(name,callback){if(disabled.includes(name)){let idx=disabled.indexOf(name);~idx&&disabled.splice(idx,1)}return enabled.push(name),getPlugin(name).onEnable(),new Promise(a=>{sendCommand("enable-plugin",[name],(...b)=>{callback&&callback(...b),a(...b)})})}async function evalPlugin(url,enable=!1,update){try{let response=await REST.get(url),code=response.text,name=url.split("/").pop().split(".")[0],id=Number(Object.keys(window.modules).pop())+1,wrapper=`__d(function(...args) {
        try {
          ${code}
        } catch(err) {
          console.log(err);
        }
      }, ${id}, []);
      __r(${id})`;try{eval(wrapper),enable&&!enabled.includes(name)&&await enablePlugin(name)}catch(e){console.log("Failed to eval plugin instance",e.message)}return update&&update(),name}catch(e){console.log("Failed to eval plugin instance",e.message)}}function installPlugin(url,callback,update){let name1=url.split("/").pop().split(".")[0];return new Promise(a=>{sendCommand("install-plugin",[url],c=>{function b(){evalPlugin(url,!0).then(d=>{let b={name:d,data:c,url};Events$1.emit("installed"),callback&&callback(b),update(),a(b)})}return"overridden_plugin"===c?disablePlugin(name1,!0).then(b):b()})})}function uninstallPlugin(name,callback){return new Promise(a=>{disablePlugin(name),sendCommand("uninstall-plugin",[name],b=>{enabled=enabled.filter(a=>a!==name),disabled=disabled.filter(a=>a!==name);let c=plugins$1.findIndex(a=>a.name===name);c> -1&&plugins$1.splice(c,1),Events$1.emit("uninstalled"),callback&&callback(b),a(b)})})}var Plugins=Object.freeze({__proto__:null,registerPlugin:registerPlugin,on:on$1,once:once$1,off:off$1,getPlugin:getPlugin,getPlugins:getPlugins,getEnabledPlugins:getEnabledPlugins,getDisabledPlugins:getDisabledPlugins,disablePlugin:disablePlugin,enablePlugin:enablePlugin,evalPlugin:evalPlugin,installPlugin:installPlugin,uninstallPlugin:uninstallPlugin});function reloadDiscord(){return Native.BundleUpdaterManager.reload()}function getVersion(){return Native.InfoDictionaryManager.Version}function getBuild(){return Native.InfoDictionaryManager.Build}function getDevice(){return Native.DCDDeviceManager.device}function getSystemVersion(){return Native.DCDDeviceManager.systemVersion}let theme=window.themes?.theme??"",themes$2=window.themes?.list??[];const EventEmitter=getByProps("EventEmitter").EventEmitter,Events=new EventEmitter,on=Events.on.bind(Events),once=Events.once.bind(Events),off=Events.off.bind(Events);function getTheme(){return theme}function getThemeByName(name){return themes$2.find(a=>a.name===name)}function listThemes(){return themes$2}async function installTheme(url,callback){return new Promise(a=>{sendCommand("install-theme",[url],b=>{REST.get(url).then(f=>{let c=JSON.parse(f.text);if(!c)throw new Error("Invalid theme structure");let d=themes$2.findIndex(a=>a.name===c.name);d> -1&&themes$2.splice(d,1),themes$2.push(c);let e={theme:c,url,data:b,restart:getTheme()===c.name};callback&&callback(e),Events.emit("installed"),a(e)})})})}function applyTheme(name,callback){return new Promise(a=>{sendCommand("apply-theme",[name,Theme.theme],b=>{theme=name,callback&&callback(b),a(b)})})}function removeTheme(callback){return new Promise(a=>{sendCommand("remove-theme",[],b=>{theme="",callback&&callback(b),a(b)})})}async function uninstallTheme(name,callback){return getTheme()===name&&removeTheme(),new Promise(a=>{sendCommand("uninstall-theme",[name],b=>{let c=themes$2.findIndex(a=>a.name===name);c> -1&&themes$2.splice(c,1),Events.emit("uninstalled"),callback&&callback(b),a(b)})})}var Themes=Object.freeze({__proto__:null,on:on,once:once,off:off,getTheme:getTheme,getThemeByName:getThemeByName,listThemes:listThemes,installTheme:installTheme,applyTheme:applyTheme,removeTheme:removeTheme,uninstallTheme:uninstallTheme});function findInTree(tree={},filter=a=>a,{ignore=[],walkable=[],maxProperties=100}={}){let stack=[tree],wrapFilter=function(...a){try{return Reflect.apply(filter,this,a)}catch{return!1}};for(;stack.length&&maxProperties;){let node=stack.shift();if(wrapFilter(node))return node;if(Array.isArray(node))stack.push(...node);else if("object"==typeof node&&null!==node){if(walkable.length)for(let key in node){let value=node[key];~walkable.indexOf(key)&&!~ignore.indexOf(key)&&stack.push(value)}else for(let key in node){let value=node[key];node&& ~ignore.indexOf(key)||stack.push(value)}}maxProperties--}}function findInReactTree(tree,filter=a=>a,options={}){return findInTree(tree,filter,{walkable:["props","children"],...options})}const Patcher$2=patcher.create("enmity-sheet-patcher"),patches={},Opener=getByProps("openLazy");function before(caller,sheet,callback){validateArguments(caller,sheet,callback),push("before",caller,sheet,callback)}function after(caller,sheet,callback){validateArguments(caller,sheet,callback),push("after",caller,sheet,callback)}function instead(caller,sheet,callback){validateArguments(caller,sheet,callback),push("instead",caller,sheet,callback)}function unpatchAll(caller){for(let patch in patches){let sheet=patches[patch];patches[sheet]=sheet.filter(a=>a.caller!==caller)}return Patcher$2.unpatchAll(caller)}function create(caller){return{before:(a,b)=>before(caller,a,b),after:(a,b)=>after(caller,a,b),instead:(a,b)=>instead(caller,a,b),unpatchAll:()=>unpatchAll(caller)}}function push(type,caller,sheet,callback){setTimeout(()=>console.log(callback.name),2e3),patches[sheet]??=[],patches[sheet].push({type,caller,sheet,callback,applied:!1})}function validateArguments(caller,sheet,callback){if(caller&&"string"==typeof caller){if(sheet&&"string"==typeof sheet){if(!callback||"function"!=typeof callback)throw new TypeError("third argument callback does not exist or is not of type function")}else throw new TypeError("second argument menu does not exist or is not of type string")}else throw new TypeError("first argument caller does not exist or is not of type string")}Patcher$2.before(Opener,"openLazy",(d,[a,b,e,c])=>{patches[b]&&(console.log(c),a.then(a=>{let c=Patcher$2.after(a,"default",(f,g,e)=>{for(let d=0;d<patches[b].length;d++){let a=patches[b][d];if(a.applied)continue;let h=a.callback;patcher[a.type](a.caller,e.type,"render",(b,c,d)=>{let a=findInReactTree(c[0],a=>a.find?.(a=>Array.isArray(a)));if(a)return a[0]?.props,a[1],h.apply(b,[b,c,d])}),a.applied=!0}return c(),e});return a}))});var SheetPatcher={patches,unpatchAll,instead,create,before,after};const{Alert,Button,FlatList,Image,ImageBackground,KeyboardAvoidingView,Modal,Pressable,RefreshControl,ScrollView,SectionList,StatusBar,StyleSheet,Switch,Text,TextInput,TouchableHighlight,TouchableOpacity,TouchableWithoutFeedback,Touchable,View,VirtualizedList}=Components$1.General,{Form,FormArrow,FormCTA,FormCTAButton,FormCardSection,FormCheckbox,FormDivider,FormHint,FormIcon,FormInput,FormLabel,FormRadio,FormRow,FormSection,FormSelect,FormSubLabel,FormSwitch,FormTernaryCheckBox,FormText,FormTextColors,FormTextSizes}=Components$1.Forms;var Components=Object.freeze({__proto__:null,Alert:Alert,Button:Button,FlatList:FlatList,Image:Image,ImageBackground:ImageBackground,KeyboardAvoidingView:KeyboardAvoidingView,Modal:Modal,Pressable:Pressable,RefreshControl:RefreshControl,ScrollView:ScrollView,SectionList:SectionList,StatusBar:StatusBar,StyleSheet:StyleSheet,Switch:Switch,Text:Text,TextInput:TextInput,TouchableHighlight:TouchableHighlight,TouchableOpacity:TouchableOpacity,TouchableWithoutFeedback:TouchableWithoutFeedback,Touchable:Touchable,View:View,VirtualizedList:VirtualizedList,Form:Form,FormArrow:FormArrow,FormCTA:FormCTA,FormCTAButton:FormCTAButton,FormCardSection:FormCardSection,FormCheckbox:FormCheckbox,FormDivider:FormDivider,FormHint:FormHint,FormIcon:FormIcon,FormInput:FormInput,FormLabel:FormLabel,FormRadio:FormRadio,FormRow:FormRow,FormSection:FormSection,FormSelect:FormSelect,FormSubLabel:FormSubLabel,FormSwitch:FormSwitch,FormTernaryCheckBox:FormTernaryCheckBox,FormText:FormText,FormTextColors:FormTextColors,FormTextSizes:FormTextSizes});function _extends$2(){return(_extends$2=Object.assign||function(d){for(var a=1;a<arguments.length;a++){var b=arguments[a];for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c])}return d}).apply(this,arguments)}const Icon=getByTypeName("Icon"),{ThemeColorMap:ThemeColorMap$7}=ColorMap;function patchDownloader(){SheetPatcher.after("enmity-downloader","MessageLongPressActionSheet",(g,[{channel:d,message:a},b])=>{let c=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$7.INTERACTIVE_NORMAL}});if(AddonChannels.Plugins.includes(d.id)){let e=a.content.match(/http(|s).+.js/gmi)?.[0];if(!e)return;b.unshift(React.createElement(FormRow,{label:"Install Plugin",leading:React.createElement(Icon,_extends$2({},c.icon,{size:"medium",disableColor:!1,source:getIDByName("ic_download_24px")})),onPress(){installPlugin(e,({data:b})=>{let a={icon:null,text:null};switch(b){case"fucky_wucky":a.text="Failed plugin installation.",a.icon=getIDByName("ic_close_16px");break;case"installed_plugin":a.text="Plugin has been installed.",a.icon=getIDByName("Check");break;case"overridden_plugin":a.text="Plugin has been overriden.",a.icon=getIDByName("Check")}Toasts.open({content:a.text,source:a.icon})})}}))}if(AddonChannels.Themes.includes(a.channel_id)){let f=a.content.match(/http(|s).+.json/gmi)?.[0];if(!f)return;b.unshift(React.createElement(FormRow,{label:"Install Theme",leading:React.createElement(Icon,_extends$2({},c.icon,{size:"medium",disableColor:!1,source:getIDByName("ic_download_24px")})),onPress(){installTheme(f,({data:c,restart:b})=>{let a={icon:null,text:null,restart:!1};switch(c){case"fucky_wucky":a.text="Failed theme installation.",a.icon=getIDByName("ic_close_16px");break;case"installed_theme":a.text="Theme has been installed.",a.icon=getIDByName("Check"),a.restart=b;break;case"overridden_theme":a.text="Theme has been overriden.",a.icon=getIDByName("Check"),a.restart=b}if(Toasts.open({content:a.text,source:a.icon}),a.restart)return Dialog.show({title:"Theme Replaced",body:"Replacing the theme you previously had applied requires a restart, would you like to restart Discord to reload the theme values?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}}))}})}const Settings=NavigationStack.createStackNavigator(),{ThemeColorMap:ThemeColorMap$6}=ColorMap;function PluginSettings({name="hi",children=React.createElement(Text,null,"hi")}={}){let styles=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,flex:1},cardStyle:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_PRIMARY,color:ThemeColorMap$6.TEXT_NORMAL},header:{backgroundColor:ThemeColorMap$6.BACKGROUND_MOBILE_SECONDARY,shadowColor:"transparent",elevation:0},headerTitleContainer:{color:ThemeColorMap$6.HEADER_PRIMARY},close:{color:ThemeColorMap$6.HEADER_PRIMARY}});return React.createElement(NavigationNative.NavigationContainer,null,React.createElement(Settings.Navigator,{initialRouteName:name,style:styles.container,screenOptions:{cardOverlayEnabled:!1,cardShadowEnabled:!1,cardStyle:styles.cardStyle,headerStyle:styles.header,headerTitleContainerStyle:styles.headerTitleContainer,headerTitleAlign:"center",safeAreaInsets:{top:0}}},React.createElement(Settings.Screen,{name:name,component:children,options:{headerTitleStyle:{color:"white"},headerLeft:()=>React.createElement(Button,{color:styles.close.color,title:"Close",onPress:()=>Navigation.pop()}),...NavigationStack.TransitionPresets.ModalSlideFromBottomIOS}})))}const{ThemeColorMap:ThemeColorMap$5}=ColorMap;function Authors({authors}){if(!authors||!Array.isArray(authors)||!authors.length)return null;let styles=StyleSheet$1.createThemedStyleSheet({linkless:{color:ThemeColorMap$5.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",alignItems:"center",alignSelf:"center",justifyContent:"center"},link:{color:ThemeColorMap$5.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,display:"flex",alignItems:"center",alignSelf:"center",justifyContent:"center"},container:{marginLeft:2.5}});return React.createElement(View,{style:styles.container},authors.map((a,c)=>{let b=c!==authors.length-1;return"string"==typeof a?React.createElement(Text,{style:styles.linkless},a,b&&","):"object"==typeof a&&a.name&&!a.id?React.createElement(Text,{style:styles.linkless},a.name,b&&","):"object"==typeof a&&a.name&&a.id?React.createElement(TouchableOpacity,{key:a.id,onPress:()=>Profiles.showUserProfile({userId:a.id})},React.createElement(Text,{style:styles.link},a.name,b&&",")):null}).filter(Boolean))}const{createThemedStyleSheet:createThemedStyleSheet$1}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$4}=ColorMap;function PluginCard({plugin}){let plugins=getEnabledPlugins(),[enabled,setEnabled]=React.useState(plugins.includes(plugin.name)),styles=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$4.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:plugin.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$4.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$4.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$4.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center"},delete:{marginRight:7.5},trashIcon:{width:22,height:22,tintColor:"white"},settingsIcon:{width:22,height:22,tintColor:"white"}}),Settings=plugin.getSettingsPanel;return React.createElement(View,{style:styles.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:styles.info},React.createElement(Text,{style:styles.name},plugin.name),plugin.version&&React.createElement(Text,{style:styles.version},plugin.version," ",plugin.authors&&"by"),React.createElement(Authors,{authors:plugin.authors})),trailing:()=>React.createElement(View,{style:styles.actions},Settings&&React.createElement(TouchableOpacity,{style:styles.delete,onPress(){Navigation.push(PluginSettings,{name:plugin.name,children:connectComponent(Settings,plugin.name)})}},React.createElement(Image,{style:styles.settingsIcon,source:Assets$1.getIDByName("settings")})),React.createElement(TouchableOpacity,{style:styles.delete,onPress:()=>void uninstallPlugin(plugin.name)},React.createElement(Image,{style:styles.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:enabled,onValueChange(a){setEnabled(a),Toasts.open({content:`${plugin.name} has been ${a?"enabled":"disabled"}.`}),a?enablePlugin(plugin.name):disablePlugin(plugin.name)}}))})),React.createElement(View,{style:styles.content},React.createElement(Text,{style:styles.description},plugin.description??"No description provided.")))}function HeaderRight$2(){let styles=createThemedStyleSheet$1({header:{tintColor:ThemeColorMap$4.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:styles.wrapper,onPress(){Alert.prompt("Install a plugin","Please enter the URL of the plugin to install.",a=>{if(!a.endsWith("js"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});installPlugin(a,({data:b})=>{let a={icon:null,text:null};switch(b){case"fucky_wucky":a.text="Failed plugin installation.",a.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_plugin":a.text="Plugin has been installed.",a.icon=Assets$1.getIDByName("Check");break;case"overridden_plugin":a.text="Plugin has been overriden.",a.icon=Assets$1.getIDByName("Check")}Toasts.open({content:a.text,source:a.icon})})})}},React.createElement(Image,{style:styles.header,source:Assets$1.getIDByName("add_white")}))}const Search$1=getModule(a=>"StaticSearchBarContainer"===a.name);function Page$2(){let forceUpdate=React.useState(null)[1],[plugins,setPlugins]=React.useState(getPlugins().sort((a,b)=>a.name.localeCompare(b.name))),[refreshing,setRefreshing]=React.useState(!1),[search,setSearch]=React.useState(null);React.useEffect(()=>{function a(){forceUpdate({})}return on$1("installed",a),on$1("uninstalled",a),()=>{off$1("installed",a),off$1("uninstalled",a)}},[]);let entities=search?plugins.filter(a=>!!(a.name.toLowerCase().includes(search.toLowerCase())||a.description?.toLowerCase().includes(search.toLowerCase())||a.authors?.find?.(a=>(a.name??a).toLowerCase().includes(search.toLowerCase())))):plugins,styles=createThemedStyleSheet$1({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$4.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{margin:0,marginBottom:0,paddingBottom:5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0,background:"none"}});return React.createElement(React.Fragment,null,React.createElement(Search$1,{style:styles.search,placeholder:"Search plugins...",onChangeText:a=>setSearch(a)}),React.createElement(View,{style:styles.container},React.createElement(ScrollView,{style:styles.container,refreshControl:React.createElement(RefreshControl,{refreshing:refreshing,onRefresh(){setRefreshing(!0),setPlugins(getPlugins()),setRefreshing(!1)}})},entities.length?entities.map(a=>React.createElement(PluginCard,{plugin:a})):search?React.createElement(View,{style:styles.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:styles.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...styles.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:styles.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:styles.notFoundText},"You don't have any plugins."),React.createElement(Text,{style:{...styles.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}const{createThemedStyleSheet}=StyleSheet$1,{ThemeColorMap:ThemeColorMap$3}=ColorMap;function ThemeCard({theme}){let currentTheme=getTheme(),[enabled,setEnabled]=React.useState(currentTheme===theme.name),styles=StyleSheet$1.createThemedStyleSheet({container:{backgroundColor:ThemeColorMap$3.BACKGROUND_SECONDARY,borderRadius:5,borderLeftColor:theme.color??"#524FBF",borderLeftWidth:5,marginBottom:15},name:{color:ThemeColorMap$3.HEADER_PRIMARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,fontSize:16},version:{color:ThemeColorMap$3.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,marginLeft:2.5},content:{height:"auto",paddingBottom:10,paddingLeft:10,paddingRight:10},actions:{justifyContent:"flex-end",flexDirection:"row",alignItems:"center"},description:{color:ThemeColorMap$3.HEADER_SECONDARY,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD},info:{marginLeft:-6,flexDirection:"row",alignItems:"center"},delete:{marginRight:7.5},trashIcon:{width:22,height:22}});return React.createElement(View,{style:styles.container},React.createElement(View,null,React.createElement(FormRow,{label:()=>React.createElement(View,{style:styles.info},React.createElement(Text,{style:styles.name},theme.name),theme.version&&React.createElement(Text,{style:styles.version},theme.version," ",theme.authors&&"by"),React.createElement(Authors,{authors:theme.authors})),trailing:()=>React.createElement(View,{style:styles.actions},React.createElement(TouchableOpacity,{style:styles.delete,onPress(){uninstallTheme(theme.name,()=>{enabled&&Dialog.show({title:"Theme Uninstalled",body:"Uninstalling the theme you previously had applied requires a restart, would you like to restart Discord to remove the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}},React.createElement(Image,{style:styles.trashIcon,source:Assets$1.getIDByName("ic_trash_filled_16px")})),React.createElement(FormSwitch,{value:enabled,onValueChange(a){setEnabled(a),Toasts.open({content:`${theme.name} has been ${a?"enabled":"disabled"}.`}),a?(applyTheme(theme.name),Dialog.show({title:"Theme Applied",body:"Applying a theme requires a restart, would you like to restart Discord to apply the theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})):(removeTheme(),Dialog.show({title:"Theme Removed",body:"Removing the applied theme requires a restart, would you like to restart Discord to remove the applied theme?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord}))}}))})),React.createElement(View,{style:styles.content},React.createElement(Text,{style:styles.description},theme.description??"No description provided.")))}function HeaderRight$1(){let styles=createThemedStyleSheet({header:{tintColor:ThemeColorMap$3.HEADER_PRIMARY,marginRight:15,width:18,height:18},wrapper:{marginRight:15,width:32,height:32}});return React.createElement(TouchableOpacity,{styles:styles.wrapper,onPress(){Alert.prompt("Install a theme","Please enter the URL of a theme to install.",a=>{if(!a.endsWith("json"))return Toasts.open({content:"Invalid URL for theme",source:Assets$1.getIDByName("ic_close_16px")});try{installTheme(a,({data:c,restart:b})=>{let a={icon:null,text:null,restart:!1};switch(c){case"fucky_wucky":a.text="Failed theme installation.",a.icon=Assets$1.getIDByName("ic_close_16px");break;case"installed_theme":a.text="Theme has been installed.",a.icon=Assets$1.getIDByName("Check"),a.restart=b;break;case"overridden_theme":a.text="Theme has been overriden.",a.icon=Assets$1.getIDByName("Check"),a.restart=b}if(Toasts.open({content:a.text,source:a.icon}),a.restart)return Dialog.show({title:"Theme Replaced",body:"Replacing the theme you previously had applied requires a restart, would you like to restart Discord to reload the theme values?",confirmText:"Yes",cancelText:"No",onConfirm:reloadDiscord})})}catch(b){Toasts.open({content:b.message})}})}},React.createElement(Image,{style:styles.header,source:Assets$1.getIDByName("add_white")}))}const Search=getModule(a=>"StaticSearchBarContainer"===a.name);function Page$1(){let forceUpdate=React.useState(null)[1],[themes,setThemes]=React.useState(listThemes().sort((a,b)=>a.name.localeCompare(b.name))),[refreshing,setRefreshing]=React.useState(!1),[search,setSearch]=React.useState(null);React.useEffect(()=>{function a(){forceUpdate({})}return on("installed",a),on("uninstalled",a),()=>{off("installed",a),off("uninstalled",a)}},[]);let entities=search?themes.filter(a=>!!(a.name.toLowerCase().includes(search.toLowerCase())||a.description?.toLowerCase().includes(search.toLowerCase())||a.authors?.find?.(a=>(a.name??a).toLowerCase().includes(search.toLowerCase())))):themes,styles=createThemedStyleSheet({container:{flex:1,padding:5},notFound:{display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center",marginTop:"50%"},notFoundText:{marginTop:10,color:ThemeColorMap$3.TEXT_MUTED,fontFamily:Constants.Fonts.PRIMARY_SEMIBOLD,textAlign:"center"},search:{margin:0,marginBottom:0,paddingBottom:5,paddingRight:10,paddingLeft:10,backgroundColor:"none",borderBottomWidth:0,background:"none"}});return React.createElement(React.Fragment,null,React.createElement(Search,{style:styles.search,placeholder:"Search themes...",onChangeText:a=>setSearch(a)}),React.createElement(View,{style:styles.container},React.createElement(ScrollView,{style:styles.container,refreshControl:React.createElement(RefreshControl,{refreshing:refreshing,onRefresh(){setRefreshing(!0),setThemes(listThemes()),setRefreshing(!1)}})},entities.length?entities.map(a=>React.createElement(ThemeCard,{theme:a})):search?React.createElement(View,{style:styles.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_no_results_dark")}),React.createElement(Text,{style:styles.notFoundText},"We searched far and wide."),React.createElement(Text,{style:{...styles.notFoundText,marginTop:0}},"Unfortunately, no results were found.")):React.createElement(View,{style:styles.notFound},React.createElement(Image,{source:Assets$1.getIDByName("img_connection_empty_dark")}),React.createElement(Text,{style:styles.notFoundText},"You don't have any themes."),React.createElement(Text,{style:{...styles.notFoundText,marginTop:0}},"Install some by clicking the + icon!")))))}function _extends$1(){return(_extends$1=Object.assign||function(d){for(var a=1;a<arguments.length;a++){var b=arguments[a];for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c])}return d}).apply(this,arguments)}const{ThemeColorMap:ThemeColorMap$2}=ColorMap;function PluginIcon({height,width,...rest}){let styles=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$2.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,_extends$1({viewBox:"0 0 24 24",style:{height,width,...styles.icon},fill:"currentColor"},rest),React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M20.5 11H19V7c0-1.1-.9-2-2-2h-4V3.5C13 2.12 11.88 1 10.5 1S8 2.12 8 3.5V5H4c-1.1 0-1.99.9-1.99 2v3.8H3.5c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-1.5c0-1.49 1.21-2.7 2.7-2.7 1.49 0 2.7 1.21 2.7 2.7V22H17c1.1 0 2-.9 2-2v-4h1.5c1.38 0 2.5-1.12 2.5-2.5S21.88 11 20.5 11z"}))}function _extends(){return(_extends=Object.assign||function(d){for(var a=1;a<arguments.length;a++){var b=arguments[a];for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c])}return d}).apply(this,arguments)}const{ThemeColorMap:ThemeColorMap$1}=ColorMap;function ThemeIcon({height,width,...rest}){let styles=StyleSheet$1.createThemedStyleSheet({icon:{color:ThemeColorMap$1.INTERACTIVE_NORMAL,opacity:.75,marginLeft:.5}});return React.createElement(SVG.Svg,_extends({viewBox:"0 0 24 24",style:{height,width,...styles.icon},fill:"currentColor"},rest),React.createElement(SVG.Path,{d:"M0 0h24v24H0z",fill:"none"}),React.createElement(SVG.Path,{d:"M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}))}const ThemeColorMap=ColorMap.ThemeColorMap;function HeaderRight(){return null}function Page({settings}){let styles=StyleSheet$1.createThemedStyleSheet({debugText:{color:ThemeColorMap.TEXT_MUTED}}),Icons={Twitter:getIDByName("img_account_sync_twitter_white"),GitHub:getIDByName("img_account_sync_github_white"),Addon:getIDByName("img_nitro_increase_guild_limit"),Checkmark:getIDByName("Check"),Discord:getIDByName("Discord")},Plugins=[...window.plugins.enabled,...window.plugins.disabled],Themes=listThemes().map(a=>a.name);return React.createElement(ScrollView,null,React.createElement(KeyboardAvoidingView,{enabled:!0,behavior:"position",style:styles.container,keyboardVerticalOffset:100,contentContainerStyle:{backfaceVisibility:"hidden"}},React.createElement(FormSection,{title:"Links"},React.createElement(FormRow,{label:"GitHub",leading:React.createElement(FormRow.Icon,{source:Icons.GitHub}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://github.com/enmity-mod")}),React.createElement(FormRow,{label:"Twitter",leading:React.createElement(FormRow.Icon,{source:Icons.Twitter}),trailing:FormRow.Arrow,onPress:()=>Linking.openURL("https://twitter.com/EnmityApp")})),React.createElement(FormSection,{title:"Debug"},React.createElement(FormRow,{label:"Discord Version",leading:React.createElement(FormRow.Icon,{source:Icons.Discord}),trailing:()=>React.createElement(Text,{style:styles.debugText},getVersion()),onPress(){Toasts.open({content:"Copied to clipboard",source:Icons.Checkmark}),Clipboard.setString(getVersion())}}),React.createElement(FormRow,{label:"Enmity Version",leading:React.createElement(FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:()=>React.createElement(Text,{style:styles.debugText},window.enmity.version),onPress:()=>Linking.openURL(`https://github.com/enmity-mod/enmity/commit/${window.enmity.version}`)}),React.createElement(FormRow,{label:"Installed Plugins",leading:React.createElement(PluginIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:styles.debugText},Plugins.length),onPress(){Toasts.open({content:"Copied to clipboard",source:Icons.Checkmark}),Clipboard.setString(`**Plugins**: ${Plugins.join(", ")}`)}}),React.createElement(FormRow,{label:"Installed Themes",leading:React.createElement(ThemeIcon,{width:24,height:24}),trailing:()=>React.createElement(Text,{style:styles.debugText},Themes.length),onPress(){Toasts.open({content:"Copied to clipboard",source:Icons.Checkmark}),Clipboard.setString(`**Themes**: ${Themes.join(", ")}`)}}),React.createElement(FormRow,{label:"Automatically connect to debug websocket",trailing:React.createElement(FormSwitch,{value:settings.getBoolean("autoConnectWS",!1),onValueChange(){settings.toggle("autoConnectWS",!1),settings.get("autoConnectWS",!1)?connectWebsocket():socket.close()}})}),settings.getBoolean("autoConnectWS",!1)&&React.createElement(FormInput,{value:settings.get("debugWSAddress","192.168.0.1:9090"),onChange:a=>settings.set("debugWSAddress",a),title:"DEBUG IP"}))))}const Patcher$1=create$1("enmity-settings");function patchSettings(){patchScreens(),patchSettings$1()}function patchScreens(){Patcher$1.after(Scenes,"default",(b,c,a)=>({...a,Enmity:{key:"Enmity",title:"Enmity",render:connectComponent(Page,"enmity"),headerRight:HeaderRight},EnmityPlugins:{key:"Enmity Plugins",title:"Plugins",render:Page$2,headerRight:HeaderRight$2},EnmityThemes:{key:"Enmity Themes",title:"Themes",render:Page$1,headerRight:HeaderRight$1}}))}const patch={status:!1,forceUpdate(){},navigator:null,handleSectionSelect(){}};function patchSettings$1(){let Settings=getByTypeName("UserSettingsOverviewWrapper",{default:!1});Patcher$1.after(Settings,"default",(c,d,a)=>{let e=React.useState({})[1];patch.forceUpdate=()=>e({});let{navigation:b}=a.props;patch.navigator=b,patch.status||(Patcher$1.after(a.type.prototype,"render",(f,g,d)=>{let{children:c}=d.props,e=c.findIndex(a=>a.props.title===Locale.Messages.PREMIUM_SETTINGS);patch.handleSectionSelect=(...b)=>a.type.prototype.handleSectionSelect.apply(f,b),c.splice(e,0,React.createElement(React.Fragment,null,React.createElement(FormSection,{key:"Enmity",title:"Enmity"},React.createElement(FormRow,{label:"General",leading:React.createElement(FormRow.Icon,{source:{uri:"https://files.enmity.app/icon-64.png"}}),trailing:React.createElement(FormArrow,null),onPress:()=>void b.push("Enmity")}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Plugins",leading:React.createElement(PluginIcon,{width:24,height:24}),trailing:React.createElement(FormArrow,null),onPress:()=>void b.push("EnmityPlugins")}),React.createElement(FormDivider,null),React.createElement(FormRow,{label:"Themes",leading:React.createElement(ThemeIcon,{width:24,height:24}),trailing:React.createElement(FormArrow,null),onPress:()=>void b.push("EnmityThemes")}),React.createElement(FormDivider,null))))}),patch.status=!0)})}const Patcher=create$1("no-track"),blacklist=["useTrackExpressionPickerInlineStickersUpsell","useTrackThreadArchivalDurationUpsell","useAndTrackNonFriendDMAccept","StreamRTCAnalyticsContext","useAndTrackDMSpamAccept","useAnalyticsContext","trackExposure","SpotifyTrack","useAndTrack","TextTrack",],Trackers=getModules(a=>"object"==typeof a&&[...Object.keys(a),...Object.keys(a.__proto__),...Object.keys(a.prototype??{})].some(a=>~a.toLowerCase().indexOf("track")|| ~a.toLowerCase().indexOf("analytics"))),Reporters=getModules(a=>"object"==typeof a&&[...Object.keys(a),...Object.keys(a.__proto__),...Object.keys(a.prototype??{})].some(a=>~a.toLowerCase().indexOf("crashreport")));function patchTracking(){for(let i=0;i<Trackers.length;i++){let filter=a=>(~a.toLowerCase().indexOf("track")|| ~a.toLowerCase().indexOf("analytics"))&&!blacklist.some(b=>a===b),tracker=Trackers[i];traverse(tracker,filter),traverse(tracker.default,filter)}for(let i1=0;i1<Reporters.length;i1++){let filter=a=>~a.toLowerCase().indexOf("crashreport")&&!blacklist.some(b=>a===b),reporter=Reporters[i1];traverse(reporter,filter),traverse(reporter.default,filter)}let Sentry={main:window.__SENTRY__?.hub,client:window.__SENTRY__?.hub?.getClient()};if(Sentry.main&&Sentry.client)for(let method of(Sentry.client.close(0),Sentry.main.getStackTop().scope.clear(),Sentry.main.getScope().clear(),Patcher.instead(Sentry.main,"addBreadcrumb",()=>{}),window.__oldConsole=window.console,["debug","info","warn","error","log","assert"])){let instance=console[method];if(instance){if(instance.__sentry_original__)console[method]=instance.__sentry_original__;else if(instance.__REACT_DEVTOOLS_ORIGINAL_METHOD__){let original=instance.__REACT_DEVTOOLS_ORIGINAL_METHOD__.__sentry_original__;console[method].__REACT_DEVTOOLS_ORIGINAL_METHOD__=original}}}}function traverse(object,filter){if(!object||!filter)return;let keys=[...Object.keys(object),...Object.keys(object.__proto__),...Object.keys(object.prototype??{})].filter(filter);for(let i=0;i<keys.length;i++){let key=keys[i],type=typeof((object[key]??object.__proto__[key])??object.prototype?.[key]);!(!~["function","object"].indexOf(type)||blacklist.some(a=>key===a))&&("object"==typeof object[key]?traverse(object[key],filter):object.prototype?.[key]&&isConfigurable(object.prototype,key)?Patcher.instead(object.prototype,key,()=>Promise.resolve()):object.__proto__[key]&&isConfigurable(object.__proto__,key)?Patcher.instead(object.__proto__,key,()=>Promise.resolve()):object[key]&&isConfigurable(object,key)&&Patcher.instead(object,key,()=>Promise.resolve()))}}function isConfigurable(object,key){return!!Object.getOwnPropertyDescriptor(object,key).configurable}function initialize$3(){try{patchSettings()}catch(e){console.log("Failed to patch settings: ",e.message)}try{patchTracking()}catch(e1){console.log("Failed to patch trackers: ",e1.message)}try{patchDownloader()}catch(e2){console.log("Failed to patch addon downloader: ",e2.message)}}var CorePatches={initialize:initialize$3};function sendReply(channelID,content,username,avatarURL){let msg=Clyde$1.createBotMessage(channelID,"");msg.author.username=username??"Enmity",msg.author.avatar=avatarURL?username:"ENMITY",avatarURL&&(Avatars.BOT_AVATARS[username]=avatarURL),"string"==typeof content?msg.content=content:Object.assign(msg,content),Messages.receiveMessage(channelID,msg)}Avatars.BOT_AVATARS.ENMITY="https://github.com/enmity-mod.png";var Clyde=Object.freeze({__proto__:null,sendReply:sendReply});!function(a){a[a.BuiltIn=0]="BuiltIn",a[a.Guild=1]="Guild",a[a.DM=2]="DM"}(ApplicationCommandSectionType||(ApplicationCommandSectionType={})),function(a){a[a.Chat=1]="Chat",a[a.User=2]="User",a[a.Message=3]="Message"}(ApplicationCommandType||(ApplicationCommandType={})),function(a){a[a.BuiltIn=0]="BuiltIn",a[a.BuiltInText=1]="BuiltInText",a[a.BuiltInIntegration=2]="BuiltInIntegration",a[a.Bot=3]="Bot",a[a.Placeholder=4]="Placeholder"}(ApplicationCommandInputType||(ApplicationCommandInputType={})),function(a){a[a.Role=1]="Role",a[a.User=2]="User"}(ApplicationCommandPermissionType||(ApplicationCommandPermissionType={})),function(a){a[a.SubCommand=1]="SubCommand",a[a.SubCommandGroup=2]="SubCommandGroup",a[a.String=3]="String",a[a.Integer=4]="Integer",a[a.Boolean=5]="Boolean",a[a.User=6]="User",a[a.Channel=7]="Channel",a[a.Role=8]="Role",a[a.Mentionnable=9]="Mentionnable",a[a.Number=10]="Number"}(ApplicationCommandOptionType||(ApplicationCommandOptionType={})),function(a){a[a.ApplicationCommand=2]="ApplicationCommand",a[a.MessageComponent=3]="MessageComponent"}(InteractionTypes||(InteractionTypes={}));const list={id:"installed-plugins",applicationId:section.id,name:"plugins",displayName:"plugins",description:"List installed plugins",displayDescription:"List installed plugins",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute(g,e){let d=e.channel.id,f=getPlugins();if(0===f.length){sendReply(d,"No plugins installed.");return}let b=getEnabledPlugins(),c=getDisabledPlugins(),a="";b.length>0&&(a=`**Enabled plugins (${b.length})**:
`,a+=`> ${b.join(", ")}
`),c.length>0&&(a+=`**Disabled plugins (${c.length})**:
`,a+=`> ${c.join(", ")}`),sendReply(d,a)}},install={id:"install-plugin",applicationId:section.id,name:"install",displayName:"install",description:"Install a plugin",displayDescription:"Install a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin url",displayDescription:"Plugin url",required:!0,type:ApplicationCommandOptionType.String},],execute(a,b){let c=a[0].value,d=b.channel.id;installPlugin(c,a=>{sendReply(d,a)})}},uninstall={id:"uninstall-plugin",applicationId:section.id,name:"uninstall",displayName:"uninstall",description:"Uninstall a plugin",displayDescription:"Uninstall a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(a,b){let c=a[0].value,d=b.channel.id;uninstallPlugin(c,a=>{sendReply(d,a)})}},disable={id:"disable-plugin",applicationId:section.id,name:"disable",displayName:"disable",description:"Disable a plugin",displayDescription:"Disable a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(a,b){let c=a[0].value,d=b.channel.id;disablePlugin(c,a=>{if("yes"===a){sendReply(d,`**${c}** has been disabled.`);return}sendReply(d,`Error when disabling **${c}**.`)})}},enable={id:"enable-plugin",applicationId:section.id,name:"enable",displayName:"enable",description:"Enable a plugin",displayDescription:"Enable a plugin",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"plugin",displayName:"plugin",description:"Plugin name",displayDescription:"Plugin name",type:ApplicationCommandOptionType.String,required:!0},],execute(a,b){let c=a[0].value,d=b.channel.id;enablePlugin(c,a=>{if("yes"===a){sendReply(d,`**${c}** has been enabled.`);return}sendReply(d,`Error when enabling **${c}**.`)})}};var plugins=[list,install,uninstall,disable,enable];const themes={id:"list-themes",applicationId:section.id,name:"themes",displayName:"themes",description:"List available themes",displayDescription:"List available themes",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute(c,b){let a=listThemes();if(0===a.length){sendReply(b.channel.id,"No themes installed.");return}sendReply(b.channel.id,`**Installed themes (${a.length})**: ${a.join(", ")}`)}},apply={id:"apply-theme",applicationId:section.id,name:"apply",displayName:"apply",description:"Apply a theme",displayDescription:"Apply a theme",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"name",displayName:"name",description:"Theme's name",displayDescription:"Theme's name",type:ApplicationCommandOptionType.String,required:!0,choices:listThemes().map(a=>({name:a.name,displayName:a.name,value:a.name}))},],execute(b,c){let a=b[0].value,d=getThemeByName(a);d||sendReply(c.channel.id,"Theme couldn't be found."),applyTheme(a).then(a=>{sendReply(c.channel.id,a)})}},clear={id:"clear-theme",applicationId:section.id,name:"clear",displayName:"clear",description:"Remove applied theme",displayDescription:"Remove applied theme",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute(a,b){removeTheme().then(a=>{sendReply(b.channel.id,a)})}};var themes$1=[themes,apply,clear,];const debug={id:"debug-command",name:"debug",displayName:"debug",description:"Print out your device information",displayDescription:"Print out your device information",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltInText,execute(){let a="**Debug Info:**\n";return a+=`> Enmity: ${window.enmity.version}
`,a+=`> Discord: ${getVersion()} (${getBuild()})
`,a+=`> Device: ${getDevice()}
`,a+=`> System: ${getSystemVersion()}
`,{content:a}}},reload={id:"reload-command",name:"reload",displayName:"reload",description:"Reload Discord",displayDescription:"Reload Discord",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(a){reloadDiscord()}},getToken={id:"token-command",name:"token",displayName:"token",description:"Show your Discord's token",displayDescription:"Show your Discord's token",applicationId:section.id,type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(b,a){sendReply(a.channel.id,Token.getToken())}};var utils=[debug,reload,getToken,];const connect={id:"websocket-devtools",applicationId:section.id,name:"websocket",displayName:"websocket",description:"Connect to the websocket server",displayDescription:"Connect to the websocket server",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,options:[{name:"host",displayName:"host",description:"Host of the debugger",displayDescription:"Host of the debugger",type:ApplicationCommandOptionType.String,required:!0},],execute(a){let b=a[0].value;connectWebsocket(b)}},dump={id:"dump-command",applicationId:section.id,name:"dump",displayName:"dump",description:"Dump Discord's modules",displayDescription:"Dump Discord's modules",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltIn,execute:function(k,f){let g=f.channel.id,c=window.modules;function h(a){if("function"==typeof a)return a.toString();if(Array.isArray(a))return a.map(h);if("object"==typeof a){let b={};for(let c in a)b[c]=h(a[c]);return b}return a}for(let a of Object.keys(c))try{let b=c[a],d={id:a};if(!b.publicModule?.exports)continue;let i=b.publicModule.exports;for(let e of Object.keys(b.publicModule.exports))d[e]=h(i[e]);sendMessage(JSON.stringify(d,null,"	"))}catch(j){console.log(`Couldn't dump module ${a}`),console.log(j)}sendReply(g,"Modules has been dumped.")}};var websocket=[connect,dump,];function initialize$2(){let commands=[...plugins,...websocket,...utils,...themes$1,];registerCommands("enmity",commands)}var Commands={initialize:initialize$2};const API={modules:Modules,themer:Themes,patcher:Patcher$4,version:"9b4e77d",plugins:Plugins,clyde:Clyde,commands:Commands$2,settings:Settings$2,components:Components,native:Native,assets:Assets$2,clipboard:Clipboard,storage:Storage,token:Token,users:Users,rest:REST,react:{...React,...Components,React},dialog:{showDialog:Dialog.show},toasts:{showToast:Toasts.open}};function initialize$1(){window.enmity=API}var API$1={API,initialize:initialize$1};function initialize(){WebSocket$1.initialize(),API$1.initialize(),CorePatches.initialize(),Commands.initialize()}var Enmity={initialize};try{Enmity.initialize()}catch(error){alert(`Enmity failed to initialize: ${error.message}`),console.error(error)}
